<!DOCTYPE html>
<html lang="en"><head>
<script src="04b_Modeling_Observed_Data_files/libs/clipboard/clipboard.min.js"></script>
<script src="04b_Modeling_Observed_Data_files/libs/quarto-html/tabby.min.js"></script>
<script src="04b_Modeling_Observed_Data_files/libs/quarto-html/popper.min.js"></script>
<script src="04b_Modeling_Observed_Data_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="04b_Modeling_Observed_Data_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="04b_Modeling_Observed_Data_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="04b_Modeling_Observed_Data_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="04b_Modeling_Observed_Data_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.56">

  <meta name="author" content="Lecture 4b">
  <title>Generalized Measurement Models: Modeling Observed Data</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="04b_Modeling_Observed_Data_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="04b_Modeling_Observed_Data_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="04b_Modeling_Observed_Data_files/libs/revealjs/dist/theme/quarto.css">
  <link href="04b_Modeling_Observed_Data_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="04b_Modeling_Observed_Data_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="04b_Modeling_Observed_Data_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="04b_Modeling_Observed_Data_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Generalized Measurement Models: Modeling Observed Data</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Lecture 4b 
</div>
</div>
</div>

</section>
<section id="todays-lecture-objectives" class="slide level2">
<h2>Today’s Lecture Objectives</h2>
<ol type="1">
<li>Show different modeling specifications for different types of item response data</li>
<li>Show how parameterization differs for standardized latent variables vs.&nbsp;marker item scale identification</li>
</ol>
</section>
<section id="example-data-conspiracy-theories" class="slide level2">
<h2>Example Data: Conspiracy Theories</h2>
<p>Today’s example is from a bootstrap resample of 177 undergraduate students at a large state university in the Midwest. The survey was a measure of 10 questions about their beliefs in various conspiracy theories that were being passed around the internet in the early 2010s. Additionally, gender was included in the survey. All items responses were on a 5- point Likert scale with:</p>
<ol type="1">
<li>Strongly Disagree</li>
<li>Disagree</li>
<li>Neither Agree or Disagree</li>
<li>Agree</li>
<li>Strongly Agree</li>
</ol>
<h4 id="please-note-the-purpose-of-this-survey-was-to-study-individual-beliefs-regarding-conspiracies.-the-questions-can-provoke-some-strong-emotions-given-the-world-we-live-in-currently.-all-questions-were-approved-by-university-irb-prior-to-their-use.">Please note, the purpose of this survey was to study individual beliefs regarding conspiracies. The questions can provoke some strong emotions given the world we live in currently. All questions were approved by university IRB prior to their use.</h4>
<p>Our purpose in using this instrument is to provide a context that we all may find relevant as many of these conspiracy theories are still prevalent today.</p>
</section>
<section id="conspiracy-theory-questions-1-5" class="slide level2">
<h2>Conspiracy Theory Questions 1-5</h2>
<p>Questions:</p>
<ol type="1">
<li>The U.S. invasion of Iraq was not part of a campaign to fight terrorism, but was driven by oil companies and Jews in the U.S. and Israel.</li>
<li>Certain U.S. government officials planned the attacks of September 11, 2001 because they wanted the United States to go to war in the Middle East.</li>
<li>President Barack Obama was not really born in the United States and does not have an authentic Hawaiian birth certificate.</li>
<li>The current financial crisis was secretly orchestrated by a small group of Wall Street bankers to extend the power of the Federal Reserve and further their control of the world’s economy.</li>
<li>Vapor trails left by aircraft are actually chemical agents deliberately sprayed in a clandestine program directed by government officials.</li>
</ol>
</section>
<section id="conspiracy-theory-questions-6-10" class="slide level2">
<h2>Conspiracy Theory Questions 6-10</h2>
<p>Questions:</p>
<ol start="6" type="1">
<li>Billionaire George Soros is behind a hidden plot to destabilize the American government, take control of the media, and put the world under his control.</li>
<li>The U.S. government is mandating the switch to compact fluorescent light bulbs because such lights make people more obedient and easier to control.</li>
<li>Government officials are covertly Building a 12-lane "NAFTA superhighway" that runs from Mexico to Canada through America’s heartland.</li>
<li>Government officials purposely developed and spread drugs like crack-cocaine and diseases like AIDS in order to destroy the African American community.</li>
<li>God sent Hurricane Katrina to punish America for its sins.</li>
</ol>
</section>
<section id="data-visualization-q1-q5" class="slide level2">
<h2>Data Visualization: Q1-Q5</h2>

<img data-src="04b_Modeling_Observed_Data_files/figure-revealjs/unnamed-chunk-2-1.png" width="960" class="r-stretch"></section>
<section id="data-visualization-q6-q10" class="slide level2">
<h2>Data Visualization: Q6-Q10</h2>

<img data-src="04b_Modeling_Observed_Data_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"></section>
<section id="conspiracy-theories-assumed-latent-variable" class="slide level2">
<h2>Conspiracy Theories: Assumed Latent Variable</h2>
<p>For today’s lecture, we will assume each of the 10 items measures a single latent variable representing a <strong>person’s tendency to believe in conspiracy theories</strong></p>
<ul>
<li>We will denote this latent variable as <span class="math inline">\(\theta_p\)</span> for each person
<ul>
<li><span class="math inline">\(p\)</span> is the index for person (with <span class="math inline">\(p=1, \ldots, P\)</span>)</li>
</ul></li>
<li>We will assume this latent variable is:
<ul>
<li>Continuous</li>
<li>Normally distributed: <span class="math inline">\(\theta_p \sim N\left(\mu_\theta, \sigma_\theta \right)\)</span>
<ul>
<li>We will make differing assumptions about the scale (the latent variable mean and standard deviation) to show how syntax works for either</li>
</ul></li>
</ul></li>
<li>Across all people, we will denote the set of vector of latent variables as</li>
</ul>
<p><span class="math display">\[\boldsymbol{\Theta} = \left[\theta_1, \ldots, \theta_P \right]^T \]</span></p>
</section>
<section id="section" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Building Measurement Models</p>
</div>
</section>
<section id="measurement-model-analysis-steps" class="slide level2">
<h2>Measurement Model Analysis Steps</h2>
<ol type="1">
<li>Specify model</li>
<li>Specify scale identification method for latent variables</li>
<li>Estimate model</li>
<li>Examine model-data fit</li>
<li>Iterate between steps 1-4 until adequate fit is achieved</li>
</ol>
<h4 id="measurement-model-auxiliary-components">Measurement Model Auxiliary Components</h4>
<ol start="6" type="1">
<li>Score estimation (and secondary analyses with scores)</li>
<li>Item evaluation</li>
<li>Scale construction</li>
<li>Equating</li>
<li>Measurement invariance/differential item functioning</li>
</ol>
</section>
<section id="section-1" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Modeling Observed Variables with Normal Distributions</p>
</div>
</section>
<section id="observed-variables-with-normal-distributions" class="slide level2">
<h2>Observed Variables with Normal Distributions</h2>
<p>A psychometric model posits that one or more hypothesized latent variables predict a person’s response to observed items</p>
<ul>
<li>Our hypothesized latent variable: Tendency to Believe in Conspiracies (<span class="math inline">\(\theta_p\)</span>)
<ul>
<li>One variable: Unidimensional</li>
</ul></li>
<li>Each observed variable (item response) is included in the model</li>
<li>Today, we will assume each response follows a normal distribution
<ul>
<li>This is the assumption underlying confirmatory factor analysis (CFA) models</li>
<li>This assumption is tenuous at best</li>
</ul></li>
</ul>
<div>
<ul>
<li class="fragment"><img data-src="https://res.cloudinary.com/teepublic/image/private/s--59x8z1rj--/t_Preview/b_rgb:191919,c_limit,f_auto,h_630,q_90,w_630/v1605371346/production/designs/16103859_0.jpg" width="200"></li>
</ul>
</div>
</section>
<section id="normal-distribution-linear-regression" class="slide level2">
<h2>Normal Distribution: Linear Regression</h2>
<p>As we saw in linear models, when an outcome variable (here <span class="math inline">\(Y_p\)</span>) is assumed to follow a (conditional) normal distribution, this places a linear regression-style model on the outcome:</p>
<p>For example, take the following linear regression: <span class="math display">\[Y_p = \beta_0 + \beta_1 X_p + e_p,\]</span> with <span class="math inline">\(e_p \sim N\left(0, \sigma_e \right)\)</span></p>
<p>This implies:</p>
<p><span class="math display">\[ Y_p \sim N\left(\beta_0 + \beta_1 X_p, \sigma_e \right)\]</span></p>
<p>Where:</p>
<ul>
<li>The (conditional) mean of <span class="math inline">\(Y_p\)</span> is <span class="math inline">\(\beta_0 + \beta_1 X_p\)</span></li>
<li>The (residual) standard deviation of <span class="math inline">\(Y_p\)</span> is <span class="math inline">\(\sigma_e\)</span></li>
</ul>
</section>
<section id="the-psychometric-model" class="slide level2">
<h2>The Psychometric Model</h2>
<p>For the psychometric model:</p>
<ul>
<li>We replace the observed variable <span class="math inline">\(X_p\)</span> with the latent variable <span class="math inline">\(\theta_p\)</span> (for all observed variables)</li>
</ul>
<p><span class="math display">\[
\begin{array}{cc}
Y_{p1} = \mu_1 + \lambda_1 \theta_p  + e_{p, 1}; &amp; e_{p,1} \sim N\left(0, \psi_1^2 \right) \\
Y_{p2} = \mu_2 + \lambda_2 \theta_p  + e_{p, 2}; &amp; e_{p,2} \sim N\left(0, \psi_2^2 \right) \\
Y_{p3} = \mu_3 + \lambda_3 \theta_p  + e_{p, 3}; &amp; e_{p,3} \sim N\left(0, \psi_3^2 \right)  \\
Y_{p4} = \mu_4 + \lambda_4 \theta_p  + e_{p, 4}; &amp; e_{p,4} \sim N\left(0, \psi_4^2 \right) \\
Y_{p5} = \mu_5 + \lambda_5 \theta_p  + e_{p, 5}; &amp; e_{p,5} \sim N\left(0, \psi_5^2 \right) \\
Y_{p6} = \mu_6 + \lambda_6 \theta_p +  e_{p, 6}; &amp; e_{p,6} \sim N\left(0, \psi_6^2 \right) \\
Y_{p7} = \mu_7 + \lambda_7 \theta_p  + e_{p, 7}; &amp; e_{p,7} \sim N\left(0, \psi_7^2 \right) \\
Y_{p8} = \mu_8 + \lambda_8 \theta_p  + e_{p, 8}; &amp; e_{p,8} \sim N\left(0, \psi_8^2 \right) \\
Y_{p9} = \mu_9 + \lambda_9 \theta_p  + e_{p, 9}; &amp; e_{p,9} \sim N\left(0, \psi_9^2 \right) \\
Y_{p10} = \mu_{10} + \lambda_{10} \theta_p  + e_{p, 10}; &amp; e_{p,10} \sim N\left(0, \psi_{10}^2 \right) \\
\end{array}
\]</span></p>
</section>
<section id="measurement-model-parameters" class="slide level2">
<h2>Measurement Model Parameters</h2>
<p>For an item <span class="math inline">\(i\)</span> the model is:</p>
<p><span class="math display">\[
\begin{array}{cc}
Y_{pi} = \mu_i + \lambda_i \theta_p  + e_{p,i}; &amp; e_{p,i} \sim N\left(0, \psi_i^2 \right) \\
\end{array}
\]</span> The parameters of the model use different notation from typical linear regression models and have different names (they are called item parameters)</p>
<ul>
<li><span class="math inline">\(\mu_i\)</span>: Item intercept
<ul>
<li>The expected score on the item when <span class="math inline">\(\theta_p = 0\)</span></li>
<li>Similar to <span class="math inline">\(\beta_0\)</span></li>
</ul></li>
<li><span class="math inline">\(\lambda_i\)</span>: Factor loading or item discrimination
<ul>
<li>The change in the expected score of an item for a one-unit increase in <span class="math inline">\(\theta_p\)</span></li>
<li>Similar to <span class="math inline">\(\beta_1\)</span></li>
</ul></li>
<li><span class="math inline">\(\psi^2_i\)</span>: Unique variance (Note: In Stan, we will have to specify <span class="math inline">\(\psi_e\)</span>; the unique standard deviation)
<ul>
<li>The variance of the residuals (the expected score minus observed score)</li>
<li>Similar to residual variance <span class="math inline">\(\sigma^2_e\)</span></li>
</ul></li>
</ul>
</section>
<section id="model-specification" class="slide level2">
<h2>Model Specification</h2>
<p>The set of equations on the previous slide formed step #1 of the Measurement Model Analysis Steps:</p>
<ol type="1">
<li>Specify Model</li>
</ol>
<p>The next step is:</p>
<ol start="2" type="1">
<li>Specify scale identification method for latent variables</li>
</ol>
<p>We will initially assume <span class="math inline">\(\theta_p \sim N(0,1)\)</span>, which allows us to estimate all item parameters of the model</p>
<ul>
<li>This is what we call a standardized latent variable
<ul>
<li>They are like Z-scores</li>
</ul></li>
</ul>
</section>
<section id="section-2" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Implementing Normal Outcomes in Stan</p>
</div>
</section>
<section id="implementing-normal-outcomes-in-stan" class="slide level2">
<h2>Implementing Normal Outcomes in Stan</h2>
<p>There are a few changes needed to make Stan estimate psychometric models with normal outcomes:</p>
<ul>
<li>The model (predictor) matrix cannot be used
<ul>
<li>This is because the latent variable will be sampled–so the model matrix cannot be formed as a constant</li>
</ul></li>
<li>The data will be imported as a matrix
<ul>
<li>More than one outcome means more than one column vector of data</li>
</ul></li>
<li>The parameters will be specified as vectors of each type
<ul>
<li>Each item will have its own set of parameters</li>
<li>Implications for the use of prior distributions</li>
</ul></li>
</ul>
</section>
<section id="stans-model-block" class="slide level2">
<h2>Stan’s <code>model</code> Block</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a>model {</span>
<span id="cb1-2"><a href=""></a>  </span>
<span id="cb1-3"><a href=""></a>  lambda <span class="sc">~</span> <span class="fu">multi_normal</span>(meanLambda, covLambda); <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> item discrimination<span class="sc">/</span>factor loadings</span>
<span id="cb1-4"><a href=""></a>  mu <span class="sc">~</span> <span class="fu">multi_normal</span>(meanMu, covMu);             <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> item intercepts</span>
<span id="cb1-5"><a href=""></a>  psi <span class="sc">~</span> <span class="fu">exponential</span>(psiRate);                   <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> unique standard deviations</span>
<span id="cb1-6"><a href=""></a>  </span>
<span id="cb1-7"><a href=""></a>  theta <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>);                         <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> latent <span class="fu">variable</span> (with mean<span class="sc">/</span>sd specified)</span>
<span id="cb1-8"><a href=""></a>  </span>
<span id="cb1-9"><a href=""></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb1-10"><a href=""></a>    Y[,item] <span class="sc">~</span> <span class="fu">normal</span>(mu[item] <span class="sc">+</span> lambda[item]<span class="sc">*</span>theta, psi[item]);</span>
<span id="cb1-11"><a href=""></a>  }</span>
<span id="cb1-12"><a href=""></a>  </span>
<span id="cb1-13"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The loop here conducts the model, separately, for each item</p>
<ul>
<li>Assumption of conditional independence enables this
<ul>
<li>Non-independence would need multivariate normal model</li>
</ul></li>
<li>The item mean is set by the conditional mean of the model
<ul>
<li>The item SD is set by the unique variance parameter</li>
</ul></li>
<li>The loop puts each item’s parameters into the equation</li>
</ul>
</section>
<section id="stans-parameters-block" class="slide level2">
<h2>Stan’s <code>parameters {}</code> Block</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a>parameters {</span>
<span id="cb2-2"><a href=""></a>  vector[nObs] theta;                <span class="sc">/</span><span class="er">/</span> the latent <span class="fu">variables</span> (one <span class="cf">for</span> each person)</span>
<span id="cb2-3"><a href=""></a>  vector[nItems] mu;                 <span class="sc">/</span><span class="er">/</span> the item <span class="fu">intercepts</span> (one <span class="cf">for</span> each item)</span>
<span id="cb2-4"><a href=""></a>  vector[nItems] lambda;             <span class="sc">/</span><span class="er">/</span> the factor loadings<span class="sc">/</span>item <span class="fu">discriminations</span> (one <span class="cf">for</span> each item)</span>
<span id="cb2-5"><a href=""></a>  vector<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span>[nItems] psi;       <span class="sc">/</span><span class="er">/</span> the unique standard <span class="fu">deviations</span> (one <span class="cf">for</span> each item)   </span>
<span id="cb2-6"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, the parameterization of <span class="math inline">\(\lambda\)</span> (factor loadings/discrimination parameters) can lead to problems in estimation</p>
<ul>
<li>The issue: <span class="math inline">\(\lambda_i \theta_p = (-\lambda_i)(-\theta_p)\)</span>
<ul>
<li>Depending on the random starting values of each of these parameters (per chain), a given chain may converge to a different region</li>
</ul></li>
<li>To demonstrate (later), we will start with a different random number seed
<ul>
<li>Currently using 09102022: works fine</li>
<li>Change to 25102022: big problems</li>
</ul></li>
<li>Our fix will be to set starting values for all <span class="math inline">\(\lambda_i\)</span> and <span class="math inline">\(\theta_p\)</span></li>
</ul>
</section>
<section id="stans-data-block" class="slide level2">
<h2>Stan’s <code>data {}</code> Block</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a>data {</span>
<span id="cb3-2"><a href=""></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> nObs;                 <span class="sc">/</span><span class="er">/</span> number of observations</span>
<span id="cb3-3"><a href=""></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> nItems;               <span class="sc">/</span><span class="er">/</span> number of items</span>
<span id="cb3-4"><a href=""></a>  matrix[nObs, nItems] Y;            <span class="sc">/</span><span class="er">/</span> item responses <span class="cf">in</span> a matrix</span>
<span id="cb3-5"><a href=""></a></span>
<span id="cb3-6"><a href=""></a>  vector[nItems] meanMu;</span>
<span id="cb3-7"><a href=""></a>  matrix[nItems, nItems] covMu;      <span class="sc">/</span><span class="er">/</span> prior covariance matrix <span class="cf">for</span> coefficients</span>
<span id="cb3-8"><a href=""></a>  </span>
<span id="cb3-9"><a href=""></a>  vector[nItems] meanLambda;         <span class="sc">/</span><span class="er">/</span> prior mean vector <span class="cf">for</span> coefficients</span>
<span id="cb3-10"><a href=""></a>  matrix[nItems, nItems] covLambda;  <span class="sc">/</span><span class="er">/</span> prior covariance matrix <span class="cf">for</span> coefficients</span>
<span id="cb3-11"><a href=""></a>  </span>
<span id="cb3-12"><a href=""></a>  vector[nItems] psiRate;            <span class="sc">/</span><span class="er">/</span> prior rate parameter <span class="cf">for</span> unique standard deviations</span>
<span id="cb3-13"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="choosing-prior-distributions-for-parameters" class="slide level2">
<h2>Choosing Prior Distributions for Parameters</h2>
<p>There is not uniform agreement about the choices of prior distributions for item parameters</p>
<ul>
<li>We will use uninformative priors on each to begin
<ul>
<li>After first model analysis, we will discuss these choices and why they were made</li>
</ul></li>
<li>For now:
<ul>
<li>Item intercepts: <span class="math inline">\(\mu_i \sim N\left(0, \sigma^2_{\mu_i} = 1000\right)\)</span></li>
<li>Factor loadings/item discriminations: <span class="math inline">\(\lambda_i \sim N(0, \sigma^2_{\lambda_i} = 1000)\)</span></li>
<li>Unique standard deviations: <span class="math inline">\(\psi_i \sim \text{exponential}\left(.01\right)\)</span></li>
</ul></li>
</ul>
</section>
<section id="prior-density-function-plots" class="slide level2">
<h2>Prior Density Function Plots</h2>

<img data-src="04b_Modeling_Observed_Data_files/figure-revealjs/unnamed-chunk-7-1.png" width="960" class="r-stretch"></section>
<section id="rs-data-list-object" class="slide level2">
<h2>R’s Data List Object</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="co"># data dimensions</span></span>
<span id="cb4-2"><a href=""></a>nObs <span class="ot">=</span> <span class="fu">nrow</span>(conspiracyItems)</span>
<span id="cb4-3"><a href=""></a>nItems <span class="ot">=</span> <span class="fu">ncol</span>(conspiracyItems)</span>
<span id="cb4-4"><a href=""></a></span>
<span id="cb4-5"><a href=""></a><span class="co"># item intercept hyperparameters</span></span>
<span id="cb4-6"><a href=""></a>muMeanHyperParameter <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb4-7"><a href=""></a>muMeanVecHP <span class="ot">=</span> <span class="fu">rep</span>(muMeanHyperParameter, nItems)</span>
<span id="cb4-8"><a href=""></a></span>
<span id="cb4-9"><a href=""></a>muVarianceHyperParameter <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb4-10"><a href=""></a>muCovarianceMatrixHP <span class="ot">=</span> <span class="fu">diag</span>(<span class="at">x =</span> muVarianceMatrixHP, <span class="at">nrow =</span> nItems)</span>
<span id="cb4-11"><a href=""></a></span>
<span id="cb4-12"><a href=""></a><span class="co"># item discrimination/factor loading hyperparameters</span></span>
<span id="cb4-13"><a href=""></a>lambdaMeanHyperParameter <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb4-14"><a href=""></a>lambdaMeanVecHP <span class="ot">=</span> <span class="fu">rep</span>(lambdaMeanHyperParameter, nItems)</span>
<span id="cb4-15"><a href=""></a></span>
<span id="cb4-16"><a href=""></a>lambdaVarianceHyperParameter <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb4-17"><a href=""></a>lambdaCovarianceMatrixHP <span class="ot">=</span> <span class="fu">diag</span>(<span class="at">x =</span> lambdaVarianceHyperParameter, <span class="at">nrow =</span> nItems)</span>
<span id="cb4-18"><a href=""></a></span>
<span id="cb4-19"><a href=""></a><span class="co"># unique standard deviation hyperparameters</span></span>
<span id="cb4-20"><a href=""></a>psiRateHyperParameter <span class="ot">=</span> .<span class="dv">01</span></span>
<span id="cb4-21"><a href=""></a>psiRateVecHP <span class="ot">=</span> <span class="fu">rep</span>(.<span class="dv">1</span>, nItems)</span>
<span id="cb4-22"><a href=""></a></span>
<span id="cb4-23"><a href=""></a>modelCFA_data <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb4-24"><a href=""></a>  <span class="at">nObs =</span> nObs,</span>
<span id="cb4-25"><a href=""></a>  <span class="at">nItems =</span> nItems,</span>
<span id="cb4-26"><a href=""></a>  <span class="at">Y =</span> conspiracyItems, </span>
<span id="cb4-27"><a href=""></a>  <span class="at">meanMu =</span> muMeanVecHP,</span>
<span id="cb4-28"><a href=""></a>  <span class="at">covMu =</span> muCovarianceMatrixHP,</span>
<span id="cb4-29"><a href=""></a>  <span class="at">meanLambda =</span> lambdaMeanVecHP,</span>
<span id="cb4-30"><a href=""></a>  <span class="at">covLambda =</span> lambdaCovarianceMatrixHP,</span>
<span id="cb4-31"><a href=""></a>  <span class="at">psiRate =</span> psiRateVecHP</span>
<span id="cb4-32"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="running-the-model-in-stan" class="slide level2">
<h2>Running the Model In Stan</h2>
<p>The Stan program takes longer to run than in linear models:</p>
<ul>
<li>Number of parameters = 207
<ul>
<li>10 observed variables (with three item parameters each: <span class="math inline">\(\mu_i\)</span>, <span class="math inline">\(\lambda_i\)</span>, and <span class="math inline">\(\psi_i\)</span>)</li>
<li>177 latent variables (one for each person: 177 parameters)</li>
</ul></li>
<li>cmdstanr samples call:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a>modelCFA_samples <span class="ot">=</span> modelCFA_stan<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb5-2"><a href=""></a>  <span class="at">data =</span> modelCFA_data,</span>
<span id="cb5-3"><a href=""></a>  <span class="at">seed =</span> <span class="dv">09102022</span>,</span>
<span id="cb5-4"><a href=""></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb5-5"><a href=""></a>  <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb5-6"><a href=""></a>  <span class="at">iter_warmup =</span> <span class="dv">2000</span>,</span>
<span id="cb5-7"><a href=""></a>  <span class="at">iter_sampling =</span> <span class="dv">2000</span>,</span>
<span id="cb5-8"><a href=""></a>  <span class="at">init =</span> <span class="cf">function</span>() <span class="fu">list</span>(<span class="at">lambda=</span><span class="fu">rnorm</span>(nItems, <span class="at">mean=</span><span class="dv">10</span>, <span class="at">sd=</span><span class="dv">2</span>),</span>
<span id="cb5-9"><a href=""></a>                         <span class="at">theta=</span><span class="fu">rnorm</span>(nObs, <span class="at">mean=</span>initTheta, <span class="at">sd=</span><span class="dv">0</span>))</span>
<span id="cb5-10"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Note: Typically, longer chains are needed for larger models like this
<ul>
<li>These will become even longer when we use non-normal distributions for observed data</li>
</ul></li>
</ul>
</section>
<section id="stans-init-option" class="slide level2">
<h2>Stan’s <code>init</code> Option</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a>  init <span class="ot">=</span> <span class="cf">function</span>() <span class="fu">list</span>(<span class="at">lambda=</span><span class="fu">rnorm</span>(nItems, <span class="at">mean=</span><span class="dv">10</span>, <span class="at">sd=</span><span class="dv">2</span>),</span>
<span id="cb6-2"><a href=""></a>                         <span class="at">theta=</span><span class="fu">rnorm</span>(nObs, <span class="at">mean=</span>initTheta, <span class="at">sd=</span><span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>The <code>init</code> option is used to set starting values for the parameters
<ul>
<li>This is especially important for the item discrimination parameters <span class="math inline">\(\lambda_i\)</span> and the latent variables <span class="math inline">\(\theta_p\)</span></li>
</ul></li>
<li>This code tells Stan to sample starting values for <span class="math inline">\(\lambda_i\)</span> from a normal distribution with mean 10 and standard deviation 2
<ul>
<li>This ensures starting values for <span class="math inline">\(\lambda_i\)</span> will most likely be positive</li>
</ul></li>
<li>For <span class="math inline">\(\theta_p\)</span>, we will need more work…</li>
</ul>
</section>
<section id="initializing-latent-variables" class="slide level2">
<h2>Initializing Latent Variables</h2>
<ul>
<li><p>As we expect the latent variable to be highly related to the sum score, we can use the sum score to help us initialize <span class="math inline">\(\theta_p\)</span> so we end up in the correct mode of the posterior distribution</p></li>
<li><p>We will use the standardized sum score as a starting value for <span class="math inline">\(\theta_p\)</span> (starting value denoted <span class="math inline">\(\theta_p^*\)</span>)</p></li>
</ul>
<p><span class="math display">\[\theta_{p}^* = \frac{\sum_{i=1}^I Y_{pi} - \text{mean}\left({\sum_{i=1}^I Y_{pi}}\right)}{\text{sd}\left({\sum_{i=1}^I Y_{pi}}\right)}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="co"># create standardized sum scores for latent variable initialization values</span></span>
<span id="cb7-2"><a href=""></a>sumScores <span class="ot">=</span> <span class="fu">rowSums</span>(conspiracyItems)</span>
<span id="cb7-3"><a href=""></a>initTheta <span class="ot">=</span> (sumScores <span class="sc">-</span> <span class="fu">mean</span>(sumScores))<span class="sc">/</span><span class="fu">sd</span>(sumScores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>We will use the standardized sum score as the starting value for <span class="math inline">\(\theta_p\)</span> in the <code>init</code> option
<ul>
<li>In my example, I set the standard deviation of the normal distribution to zero (meaning the function just returns the mean) – you can also choose to make this a small value allowing for some variability</li>
</ul></li>
</ul>
</section>
<section id="model-results" class="slide level2">
<h2>Model Results</h2>
<ul>
<li>Checking convergence with <span class="math inline">\(\hat{R}\)</span> (PSRF):</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.005758</code></pre>
</div>
</div>
<ul>
<li>Item Parameter Results:</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 10
   variable    mean median     sd    mad    q5   q95  rhat ess_bulk ess_tail
   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 mu[1]      2.37   2.37  0.0862 0.0863 2.23  2.51   1.00    1369.    2860.
 2 mu[2]      1.96   1.96  0.0840 0.0832 1.82  2.09   1.00     975.    2023.
 3 mu[3]      1.88   1.88  0.0842 0.0816 1.74  2.02   1.00    1103.    2563.
 4 mu[4]      2.01   2.01  0.0838 0.0824 1.87  2.15   1.00    1050.    2438.
 5 mu[5]      1.98   1.98  0.0840 0.0847 1.85  2.12   1.00     759.    1309.
 6 mu[6]      1.89   1.90  0.0754 0.0747 1.77  2.02   1.00     773.    1532.
 7 mu[7]      1.72   1.73  0.0759 0.0758 1.60  1.85   1.00    1108.    2316.
 8 mu[8]      1.84   1.84  0.0716 0.0707 1.73  1.96   1.00     759.    1476.
 9 mu[9]      1.81   1.81  0.0867 0.0858 1.66  1.95   1.00    1055.    2163.
10 mu[10]     1.52   1.52  0.0814 0.0814 1.39  1.65   1.00    1414.    3088.
11 lambda[1]  0.739  0.738 0.0825 0.0812 0.607 0.877  1.00    2492.    4852.
12 lambda[2]  0.871  0.870 0.0778 0.0775 0.746 1.00   1.00    1692.    3480.
13 lambda[3]  0.804  0.802 0.0779 0.0774 0.677 0.932  1.00    2056.    3944.
14 lambda[4]  0.844  0.842 0.0774 0.0776 0.721 0.974  1.00    1716.    3324.
15 lambda[5]  0.999  0.996 0.0723 0.0726 0.883 1.12   1.01    1126.    2516.
16 lambda[6]  0.900  0.896 0.0657 0.0675 0.797 1.01   1.00    1111.    2967.
17 lambda[7]  0.765  0.763 0.0702 0.0700 0.653 0.884  1.00    1731.    3725.
18 lambda[8]  0.854  0.853 0.0617 0.0631 0.756 0.958  1.00    1102.    2455.
19 lambda[9]  0.862  0.861 0.0801 0.0801 0.734 0.995  1.00    1767.    3832.
20 lambda[10] 0.673  0.671 0.0774 0.0767 0.548 0.800  1.00    2536.    4138.
21 psi[1]     0.891  0.888 0.0518 0.0517 0.810 0.980  1.00   15383.    5995.
22 psi[2]     0.734  0.732 0.0429 0.0431 0.667 0.808  1.00   12105.    6396.
23 psi[3]     0.783  0.781 0.0442 0.0439 0.714 0.857  1.00   15176.    6273.
24 psi[4]     0.758  0.756 0.0438 0.0431 0.689 0.834  1.00   13862.    5865.
25 psi[5]     0.545  0.543 0.0371 0.0362 0.487 0.610  1.00    9358.    6936.
26 psi[6]     0.505  0.504 0.0332 0.0334 0.452 0.562  1.00    8442.    6312.
27 psi[7]     0.687  0.685 0.0401 0.0399 0.624 0.755  1.00   14397.    6500.
28 psi[8]     0.480  0.479 0.0318 0.0319 0.429 0.534  1.00    9040.    6473.
29 psi[9]     0.782  0.780 0.0452 0.0443 0.711 0.860  1.00   14683.    6355.
30 psi[10]    0.840  0.838 0.0469 0.0468 0.766 0.920  1.00   15456.    5393.</code></pre>
</div>
</div>
</section>
<section id="modeling-strategy-vs.-didactic-strategy" class="slide level2">
<h2>Modeling Strategy vs.&nbsp;Didactic Strategy</h2>
<p>At this point, one should investigate model fit of the model we just ran</p>
<ul>
<li>If the model does not fit, then all model parameters could be biased
<ul>
<li>Both item parameters and person parameters (<span class="math inline">\(\theta_p\)</span>)</li>
</ul></li>
<li>Moreover, the uncertainty accompanying each parameter (the posterior standard deviation) may also be biased
<ul>
<li>Especially bad for psychometric models as we quantify reliaiblity with these numbers</li>
</ul></li>
</ul>
<p>But, to teach generalized measurement models, we will first talk about differing models for observed data</p>
<ul>
<li>Different distributions</li>
<li>Different parameterizations across the different distributions</li>
</ul>
<p>Then we will discuss model fit methods</p>
</section>
<section id="investigating-item-parameters" class="slide level2">
<h2>Investigating Item Parameters</h2>
<p>One plot that can help provide information about the item parameters is the item characteristic curve (ICC)</p>
<ul>
<li>Not called this in CFA (but equivalent)</li>
<li>The ICC is the plot of the expected value of the response conditional on the value of the latent traits, for a range of latent trait values</li>
</ul>
<p><span class="math display">\[E \left(Y_{pi} \mid \theta_p \right) = \mu_{i} +\lambda_{i}\theta_p \]</span></p>
<ul>
<li>Because we have sampled values for each parameter, we can plot one ICC for each posterior draw</li>
</ul>
</section>
<section id="posterior-icc-plots" class="slide level2">
<h2>Posterior ICC Plots</h2>

<img data-src="04b_Modeling_Observed_Data_files/figure-revealjs/unnamed-chunk-16-1.png" width="960" class="r-stretch"></section>
<section id="posterior-distribution-for-item-parameters" class="slide level2">
<h2>Posterior Distribution for Item Parameters</h2>
<p>Before moving onto the latent variables, let’s note the posterior distribution of the item parameters (for a single item):</p>
<p><span class="math display">\[f(\mu_i, \lambda_i, \psi_i \mid \boldsymbol{Y}) \propto f\left(\boldsymbol{Y} \mid \mu_i, \lambda_i, \psi_i \right)
f\left(\mu_i, \lambda_i, \psi_i \right)
\]</span></p>
<p><span class="math inline">\(f(\mu_i, \lambda_i, \psi_i \mid \boldsymbol{Y})\)</span> is the (joint) posterior distribution of the parameters for item <span class="math inline">\(i\)</span></p>
<ul>
<li>The distribution of the parameters conditional on the data</li>
</ul>
<p><span class="math inline">\(f\left(\boldsymbol{Y} \mid \mu_i, \lambda_i, \psi_i \right)\)</span> is the distribution we defined for our observed data:</p>
<p><span class="math display">\[ f\left(\boldsymbol{Y} \mid \mu_i, \lambda_i, \psi_i \right) \sim N \left(\mu_i+\lambda_i\theta_p, \psi_i \right)\]</span></p>
<p><span class="math inline">\(f\left(\mu_i, \lambda_i, \psi_i \right)\)</span> is the (joint) prior distribution for each of the parameters, which, are independent:</p>
<p><span class="math display">\[ f\left(\mu_i, \lambda_i, \psi_i \right) = f(\mu_i)f(\lambda_i)f(\psi_i)\]</span></p>
</section>
<section id="investigating-the-latent-variables" class="slide level2">
<h2>Investigating the Latent Variables</h2>
<p>The estimated latent variables are then:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 177 × 10
    variable      mean  median    sd   mad      q5      q95  rhat ess_bulk
    &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
  1 theta[1]    0.0149  0.0176 0.249 0.249 -0.399   0.425    1.00    5825.
  2 theta[2]    1.52    1.52   0.260 0.261  1.10    1.96     1.00    4026.
  3 theta[3]    1.70    1.69   0.262 0.265  1.28    2.14     1.00    3119.
  4 theta[4]   -0.930  -0.924  0.250 0.250 -1.34   -0.529    1.00    4175.
  5 theta[5]    0.0402  0.0388 0.248 0.249 -0.364   0.449    1.00    5522.
  6 theta[6]   -0.982  -0.983  0.244 0.246 -1.39   -0.585    1.00    3629.
  7 theta[7]   -0.340  -0.339  0.250 0.251 -0.752   0.0644   1.00    4861.
  8 theta[8]   -0.0576 -0.0579 0.251 0.246 -0.473   0.357    1.00    5262.
  9 theta[9]   -0.791  -0.789  0.247 0.245 -1.20   -0.392    1.00    4166.
 10 theta[10]   0.0404  0.0399 0.243 0.247 -0.358   0.435    1.00    4842.
 11 theta[11]  -0.984  -0.982  0.250 0.247 -1.40   -0.580    1.00    3779.
 12 theta[12]   0.252   0.250  0.246 0.247 -0.147   0.661    1.00    4963.
 13 theta[13]  -0.751  -0.748  0.251 0.247 -1.17   -0.349    1.00    4498.
 14 theta[14]  -0.982  -0.979  0.251 0.246 -1.40   -0.583    1.00    3831.
 15 theta[15]  -0.841  -0.837  0.247 0.246 -1.26   -0.442    1.00    4289.
 16 theta[16]  -0.0692 -0.0707 0.249 0.244 -0.478   0.347    1.00    5734.
 17 theta[17]  -0.0684 -0.0688 0.245 0.242 -0.467   0.333    1.00    4837.
 18 theta[18]  -0.668  -0.669  0.251 0.253 -1.08   -0.259    1.00    4203.
 19 theta[19]   1.86    1.86   0.274 0.274  1.41    2.32     1.00    3063.
 20 theta[20]  -0.929  -0.926  0.248 0.250 -1.34   -0.519    1.00    4091.
 21 theta[21]  -0.256  -0.255  0.243 0.234 -0.660   0.143    1.00    4999.
 22 theta[22]  -0.981  -0.980  0.251 0.250 -1.39   -0.575    1.00    4520.
 23 theta[23]  -0.980  -0.979  0.254 0.251 -1.41   -0.574    1.00    3956.
 24 theta[24]  -0.979  -0.975  0.254 0.252 -1.40   -0.563    1.00    3853.
 25 theta[25]   0.540   0.537  0.252 0.250  0.129   0.953    1.00    5490.
 26 theta[26]   0.730   0.728  0.253 0.245  0.322   1.15     1.00    4504.
 27 theta[27]  -0.118  -0.120  0.252 0.256 -0.533   0.290    1.00    4609.
 28 theta[28]   1.21    1.20   0.247 0.249  0.807   1.62     1.00    3842.
 29 theta[29]   0.886   0.885  0.247 0.247  0.480   1.30     1.00    4142.
 30 theta[30]   1.67    1.67   0.266 0.263  1.24    2.12     1.00    3570.
 31 theta[31]   0.538   0.538  0.249 0.239  0.128   0.950    1.00    4646.
 32 theta[32]  -0.418  -0.416  0.255 0.250 -0.842   0.00117  1.00    5898.
 33 theta[33]   0.318   0.316  0.245 0.244 -0.0737  0.725    1.00    5098.
 34 theta[34]  -0.981  -0.978  0.246 0.245 -1.38   -0.576    1.00    3805.
 35 theta[35]  -0.668  -0.666  0.254 0.255 -1.09   -0.257    1.00    5079.
 36 theta[36]  -0.796  -0.796  0.245 0.244 -1.20   -0.399    1.00    4946.
 37 theta[37]  -0.983  -0.985  0.246 0.245 -1.39   -0.577    1.00    3900.
 38 theta[38]  -0.220  -0.223  0.251 0.244 -0.633   0.201    1.00    5376.
 39 theta[39]  -0.983  -0.983  0.256 0.253 -1.40   -0.561    1.00    4032.
 40 theta[40]   0.0409  0.0390 0.244 0.243 -0.363   0.446    1.00    6828.
 41 theta[41]  -0.982  -0.977  0.253 0.249 -1.40   -0.571    1.00    3616.
 42 theta[42]  -0.0907 -0.0887 0.250 0.252 -0.500   0.309    1.00    5692.
 43 theta[43]  -0.647  -0.645  0.244 0.252 -1.05   -0.252    1.00    4414.
 44 theta[44]  -0.0711 -0.0723 0.246 0.239 -0.473   0.338    1.00    5027.
 45 theta[45]   0.376   0.378  0.248 0.247 -0.0402  0.782    1.00    5562.
 46 theta[46]   0.262   0.264  0.245 0.242 -0.141   0.667    1.00    6349.
 47 theta[47]   0.502   0.500  0.253 0.252  0.0882  0.918    1.00    5547.
 48 theta[48]  -0.838  -0.834  0.242 0.241 -1.25   -0.443    1.00    4463.
 49 theta[49]  -0.982  -0.981  0.251 0.246 -1.40   -0.581    1.00    3723.
 50 theta[50]   0.156   0.160  0.251 0.247 -0.257   0.572    1.00    5491.
 51 theta[51]  -0.983  -0.979  0.247 0.240 -1.40   -0.578    1.00    3752.
 52 theta[52]   0.316   0.316  0.251 0.253 -0.0926  0.730    1.00    5573.
 53 theta[53]  -0.980  -0.977  0.256 0.254 -1.40   -0.566    1.00    4192.
 54 theta[54]   1.21    1.21   0.259 0.261  0.783   1.64     1.00    3868.
 55 theta[55]  -0.980  -0.979  0.254 0.249 -1.40   -0.567    1.00    3677.
 56 theta[56]  -0.980  -0.976  0.249 0.248 -1.40   -0.578    1.00    4091.
 57 theta[57]  -0.735  -0.731  0.251 0.247 -1.15   -0.322    1.00    4310.
 58 theta[58]  -0.980  -0.978  0.250 0.248 -1.39   -0.573    1.00    4210.
 59 theta[59]  -0.0752 -0.0751 0.243 0.246 -0.479   0.331    1.00    4562.
 60 theta[60]  -0.647  -0.643  0.242 0.240 -1.05   -0.255    1.00    4092.
 61 theta[61]   1.38    1.37   0.260 0.263  0.955   1.81     1.00    3670.
 62 theta[62]   0.318   0.320  0.243 0.238 -0.0793  0.729    1.00    5113.
 63 theta[63]  -0.979  -0.978  0.247 0.248 -1.39   -0.573    1.00    4373.
 64 theta[64]   1.37    1.36   0.255 0.254  0.961   1.80     1.00    3946.
 65 theta[65]   1.20    1.20   0.248 0.245  0.804   1.62     1.00    4040.
 66 theta[66]  -0.754  -0.754  0.249 0.253 -1.16   -0.347    1.00    4548.
 67 theta[67]   0.539   0.537  0.249 0.251  0.128   0.956    1.00    5174.
 68 theta[68]   0.851   0.850  0.250 0.246  0.444   1.27     1.00    4489.
 69 theta[69]  -0.530  -0.530  0.252 0.249 -0.945  -0.115    1.00    4774.
 70 theta[70]   0.885   0.882  0.251 0.247  0.473   1.31     1.00    4849.
 71 theta[71]   0.0558  0.0570 0.243 0.243 -0.345   0.453    1.00    5378.
 72 theta[72]   1.04    1.04   0.258 0.261  0.623   1.47     1.00    4268.
 73 theta[73]  -0.0178 -0.0196 0.247 0.241 -0.419   0.395    1.00    5512.
 74 theta[74]  -0.979  -0.977  0.251 0.250 -1.39   -0.571    1.00    4231.
 75 theta[75]  -0.979  -0.981  0.254 0.258 -1.39   -0.565    1.00    4405.
 76 theta[76]   3.24    3.24   0.299 0.293  2.76    3.76     1.00    1839.
 77 theta[77]  -0.794  -0.794  0.252 0.247 -1.21   -0.378    1.00    3947.
 78 theta[78]   1.14    1.14   0.250 0.246  0.742   1.56     1.00    4008.
 79 theta[79]   1.86    1.86   0.274 0.273  1.42    2.32     1.00    3231.
 80 theta[80]   0.608   0.604  0.250 0.245  0.196   1.02     1.00    4659.
 81 theta[81]   0.0461  0.0456 0.245 0.244 -0.352   0.452    1.00    5404.
 82 theta[82]   0.0186  0.0162 0.249 0.253 -0.390   0.428    1.00    4973.
 83 theta[83]  -0.980  -0.975  0.251 0.249 -1.39   -0.573    1.00    4115.
 84 theta[84]   1.57    1.57   0.266 0.273  1.14    2.01     1.00    3701.
 85 theta[85]   0.206   0.204  0.248 0.246 -0.196   0.621    1.00    5842.
 86 theta[86]  -0.982  -0.978  0.247 0.242 -1.40   -0.581    1.00    4084.
 87 theta[87]   0.165   0.162  0.247 0.247 -0.244   0.574    1.00    5868.
 88 theta[88]  -0.319  -0.318  0.247 0.248 -0.732   0.0827   1.00    5772.
 89 theta[89]  -0.981  -0.974  0.249 0.247 -1.40   -0.578    1.00    3868.
 90 theta[90]   0.833   0.833  0.249 0.248  0.433   1.25     1.00    4588.
 91 theta[91]  -0.838  -0.832  0.251 0.255 -1.25   -0.430    1.00    4536.
 92 theta[92]   1.06    1.06   0.253 0.255  0.642   1.48     1.00    4692.
 93 theta[93]   0.0168  0.0140 0.251 0.249 -0.393   0.433    1.00    5666.
 94 theta[94]   2.58    2.58   0.285 0.285  2.13    3.06     1.00    2315.
 95 theta[95]   1.65    1.65   0.259 0.258  1.24    2.09     1.00    3350.
 96 theta[96]   0.317   0.318  0.246 0.250 -0.0874  0.720    1.00    4429.
 97 theta[97]   0.262   0.260  0.247 0.245 -0.134   0.665    1.00    5927.
 98 theta[98]  -0.982  -0.979  0.254 0.252 -1.40   -0.567    1.00    4066.
 99 theta[99]   1.21    1.20   0.249 0.247  0.806   1.62     1.00    3736.
100 theta[100] -0.931  -0.926  0.248 0.244 -1.34   -0.533    1.00    4439.
101 theta[101] -0.707  -0.706  0.245 0.243 -1.12   -0.303    1.00    3994.
102 theta[102]  2.81    2.81   0.288 0.288  2.34    3.29     1.00    2096.
103 theta[103] -0.669  -0.666  0.255 0.257 -1.09   -0.251    1.00    4065.
104 theta[104]  0.854   0.848  0.263 0.262  0.423   1.29     1.00    4669.
105 theta[105] -0.0884 -0.0870 0.251 0.250 -0.499   0.322    1.00    5462.
106 theta[106]  1.12    1.12   0.256 0.256  0.709   1.55     1.00    4583.
107 theta[107]  1.57    1.56   0.260 0.260  1.15    2.00     1.00    3379.
108 theta[108]  0.834   0.828  0.251 0.258  0.433   1.25     1.00    4598.
109 theta[109]  1.03    1.03   0.255 0.255  0.619   1.45     1.00    4562.
110 theta[110]  0.0417  0.0406 0.246 0.246 -0.360   0.448    1.00    5277.
111 theta[111]  0.112   0.112  0.245 0.244 -0.291   0.522    1.00    5637.
112 theta[112] -0.641  -0.636  0.250 0.248 -1.06   -0.232    1.00    5001.
113 theta[113]  0.370   0.363  0.246 0.249 -0.0296  0.775    1.00    5221.
114 theta[114] -0.320  -0.324  0.245 0.245 -0.720   0.0852   1.00    4778.
115 theta[115]  0.855   0.853  0.257 0.259  0.439   1.28     1.00    4557.
116 theta[116] -0.173  -0.173  0.245 0.246 -0.580   0.228    1.00    5387.
117 theta[117]  0.0605  0.0577 0.244 0.248 -0.342   0.460    1.00    5155.
118 theta[118]  0.316   0.318  0.246 0.247 -0.0939  0.713    1.00    5385.
119 theta[119] -0.838  -0.836  0.250 0.251 -1.26   -0.438    1.00    4460.
120 theta[120] -0.980  -0.979  0.253 0.256 -1.40   -0.572    1.00    4108.
121 theta[121]  0.201   0.203  0.253 0.253 -0.219   0.608    1.00    4782.
122 theta[122] -0.642  -0.641  0.246 0.246 -1.04   -0.242    1.00    4503.
123 theta[123]  1.21    1.20   0.254 0.256  0.802   1.64     1.00    3945.
124 theta[124]  1.03    1.03   0.251 0.250  0.625   1.45     1.00    4298.
125 theta[125] -0.981  -0.975  0.245 0.248 -1.39   -0.587    1.00    3647.
126 theta[126] -0.642  -0.639  0.250 0.247 -1.05   -0.238    1.00    4406.
127 theta[127]  1.12    1.12   0.257 0.254  0.711   1.56     1.00    4306.
128 theta[128] -0.850  -0.848  0.251 0.251 -1.27   -0.435    1.00    4346.
129 theta[129] -0.669  -0.668  0.251 0.248 -1.09   -0.261    1.00    4720.
130 theta[130]  1.86    1.86   0.269 0.270  1.43    2.31     1.00    3018.
131 theta[131] -0.344  -0.341  0.246 0.251 -0.744   0.0543   1.00    4973.
132 theta[132]  1.65    1.65   0.265 0.265  1.22    2.09     1.00    3304.
133 theta[133] -0.982  -0.979  0.248 0.251 -1.40   -0.584    1.00    4315.
134 theta[134]  2.59    2.58   0.281 0.285  2.14    3.06     1.00    2168.
135 theta[135] -0.794  -0.794  0.252 0.251 -1.21   -0.379    1.00    4153.
136 theta[136] -0.980  -0.978  0.246 0.241 -1.38   -0.576    1.00    4247.
137 theta[137]  0.774   0.770  0.255 0.255  0.358   1.20     1.00    5349.
138 theta[138] -0.791  -0.792  0.248 0.249 -1.19   -0.383    1.00    4357.
139 theta[139]  0.0411  0.0432 0.245 0.250 -0.359   0.442    1.00    5791.
140 theta[140] -0.0575 -0.0591 0.244 0.247 -0.461   0.343    1.00    4311.
141 theta[141] -0.842  -0.840  0.248 0.245 -1.26   -0.434    1.00    4107.
142 theta[142] -0.978  -0.976  0.252 0.253 -1.39   -0.573    1.00    3674.
143 theta[143] -0.979  -0.978  0.247 0.246 -1.38   -0.577    1.00    4143.
144 theta[144]  0.811   0.809  0.250 0.251  0.410   1.23     1.00    4573.
145 theta[145] -0.980  -0.981  0.251 0.242 -1.39   -0.568    1.00    4024.
146 theta[146]  0.610   0.606  0.246 0.249  0.208   1.01     1.00    5099.
147 theta[147]  0.852   0.852  0.253 0.252  0.437   1.27     1.00    5151.
148 theta[148]  0.112   0.108  0.255 0.254 -0.302   0.539    1.00    5024.
149 theta[149] -0.982  -0.979  0.250 0.249 -1.40   -0.576    1.00    4031.
150 theta[150] -0.978  -0.974  0.246 0.247 -1.39   -0.579    1.00    4294.
151 theta[151] -0.641  -0.637  0.254 0.255 -1.06   -0.227    1.00    5183.
152 theta[152] -0.981  -0.980  0.249 0.252 -1.39   -0.577    1.00    4164.
153 theta[153]  1.52    1.52   0.259 0.257  1.10    1.96     1.00    3673.
154 theta[154] -0.931  -0.926  0.249 0.248 -1.34   -0.530    1.00    4235.
155 theta[155] -0.981  -0.977  0.250 0.248 -1.39   -0.574    1.00    4307.
156 theta[156] -0.838  -0.836  0.254 0.255 -1.25   -0.426    1.00    4504.
157 theta[157] -0.836  -0.836  0.251 0.255 -1.25   -0.426    1.00    4324.
158 theta[158] -0.0191 -0.0208 0.244 0.250 -0.423   0.380    1.00    5119.
159 theta[159]  0.612   0.611  0.254 0.257  0.193   1.03     1.00    4876.
160 theta[160] -0.982  -0.976  0.251 0.248 -1.40   -0.574    1.00    4076.
161 theta[161]  1.29    1.29   0.251 0.250  0.880   1.71     1.00    3820.
162 theta[162]  0.168   0.171  0.252 0.246 -0.254   0.577    1.00    5447.
163 theta[163] -0.982  -0.980  0.252 0.249 -1.40   -0.572    1.00    4085.
164 theta[164] -0.544  -0.541  0.253 0.254 -0.963  -0.128    1.00    5010.
165 theta[165]  0.157   0.160  0.253 0.249 -0.262   0.573    1.00    5206.
166 theta[166] -0.985  -0.979  0.253 0.251 -1.41   -0.583    1.00    3812.
167 theta[167]  0.319   0.317  0.244 0.245 -0.0770  0.723    1.00    5024.
168 theta[168]  1.37    1.37   0.256 0.258  0.957   1.80     1.00    3813.
169 theta[169] -0.355  -0.355  0.246 0.249 -0.749   0.0526   1.00    4343.
170 theta[170]  0.112   0.111  0.244 0.244 -0.283   0.507    1.00    5181.
171 theta[171] -0.750  -0.748  0.248 0.244 -1.16   -0.340    1.00    4338.
172 theta[172]  0.199   0.199  0.242 0.242 -0.197   0.596    1.00    5408.
173 theta[173]  0.607   0.607  0.250 0.250  0.200   1.02     1.00    5023.
174 theta[174] -0.711  -0.708  0.247 0.247 -1.12   -0.309    1.00    4031.
175 theta[175] -0.669  -0.668  0.250 0.251 -1.08   -0.263    1.00    4523.
176 theta[176] -0.791  -0.786  0.247 0.246 -1.20   -0.392    1.00    4259.
177 theta[177] -0.437  -0.437  0.255 0.251 -0.859  -0.0222   1.00    5909.
# ℹ 1 more variable: ess_tail &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="eap-estimates-of-latent-variables" class="slide level2">
<h2>EAP Estimates of Latent Variables</h2>

<img data-src="04b_Modeling_Observed_Data_files/figure-revealjs/unnamed-chunk-18-1.png" width="960" class="r-stretch"></section>
<section id="density-of-eap-estimates" class="slide level2">
<h2>Density of EAP Estimates</h2>

<img data-src="04b_Modeling_Observed_Data_files/figure-revealjs/unnamed-chunk-19-1.png" width="960" class="r-stretch"></section>
<section id="density-of-all-posterior-draws" class="slide level2">
<h2>Density of All Posterior Draws</h2>

<img data-src="04b_Modeling_Observed_Data_files/figure-revealjs/unnamed-chunk-20-1.png" width="960" class="r-stretch"></section>
<section id="comparing-two-posterior-distributions" class="slide level2">
<h2>Comparing Two Posterior Distributions</h2>

<img data-src="04b_Modeling_Observed_Data_files/figure-revealjs/unnamed-chunk-21-1.png" width="960" class="r-stretch"></section>
<section id="comparing-eap-estimate-with-posterior-sd" class="slide level2">
<h2>Comparing EAP Estimate with Posterior SD</h2>

<img data-src="04b_Modeling_Observed_Data_files/figure-revealjs/unnamed-chunk-22-1.png" width="960" class="r-stretch"></section>
<section id="comparing-eap-estimate-with-sum-score" class="slide level2">
<h2>Comparing EAP Estimate with Sum Score</h2>

<img data-src="04b_Modeling_Observed_Data_files/figure-revealjs/unnamed-chunk-23-1.png" width="960" class="r-stretch"></section>
<section id="posterior-distribution-for-person-parameters" class="slide level2">
<h2>Posterior Distribution for Person Parameters</h2>
<p>The posterior distribution of the person parameters (the latent variable; for a single person): <span class="math display">\[
f(\theta_p \mid \boldsymbol{Y}) \propto f\left(\boldsymbol{Y} \mid \theta_p \right)
f\left(\theta_p \right)
\]</span></p>
<p>Here:</p>
<ul>
<li><span class="math inline">\(f(\theta_p \mid \boldsymbol{Y})\)</span> is the posterior distribution of the latent variable conditional on the observed data</li>
<li><span class="math inline">\(f\left(\boldsymbol{Y} \mid \theta_p \right)\)</span> is the model (data) likelihood</li>
</ul>
<p><span class="math display">\[ f\left(\boldsymbol{Y} \mid \theta_p \right)  = \prod_{i=1}^I f(Y_i \mid \theta_p)\]</span></p>
<ul>
<li><span class="math inline">\(f(Y_i \mid \theta_p)\)</span> is the observed data likelihood: <span class="math inline">\(f(Y_i \mid \theta_p) \sim N(\mu_i + \lambda_i\theta_p, \psi_i)\)</span></li>
<li><span class="math inline">\(f\left(\theta_p \right) \sim N(0,1)\)</span> is the prior likelihood for the latent variable <span class="math inline">\(\theta_p\)</span></li>
<li>Technical details: <a href="https://jonathantemplin.com/wp-content/uploads/2022/10/sem15pre906_lecture11.pdf">https://jonathantemplin.com/wp-content/uploads/2022/10/sem15pre906_lecture11.pdf</a></li>
</ul>
</section>
<section id="section-3" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Measurement Model Estimation Fails</p>
</div>
</section>
<section id="recall-stans-parameters-block" class="slide level2">
<h2>Recall: Stan’s <code>parameters {}</code> Block</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a>parameters {</span>
<span id="cb11-2"><a href=""></a>  vector[nObs] theta;                <span class="sc">/</span><span class="er">/</span> the latent <span class="fu">variables</span> (one <span class="cf">for</span> each person)</span>
<span id="cb11-3"><a href=""></a>  vector[nItems] mu;                 <span class="sc">/</span><span class="er">/</span> the item <span class="fu">intercepts</span> (one <span class="cf">for</span> each item)</span>
<span id="cb11-4"><a href=""></a>  vector[nItems] lambda;             <span class="sc">/</span><span class="er">/</span> the factor loadings<span class="sc">/</span>item <span class="fu">discriminations</span> (one <span class="cf">for</span> each item)</span>
<span id="cb11-5"><a href=""></a>  vector<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span>[nItems] psi;       <span class="sc">/</span><span class="er">/</span> the unique standard <span class="fu">deviations</span> (one <span class="cf">for</span> each item)   </span>
<span id="cb11-6"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, the parameterization of <span class="math inline">\(\lambda\)</span> (factor loadings/discrimination parameters) can lead to problems in estimation</p>
<ul>
<li>The issue: <span class="math inline">\(\lambda_i \theta_p = (-\lambda_i)(-\theta_p)\)</span>
<ul>
<li>Depending on the random starting values of each of these parameters (per chain), a given chain may converge to a different region</li>
</ul></li>
<li>To demonstrate (later), we will start with a different random number seed
<ul>
<li>Currently using 09102022: works fine</li>
<li>Change to 25102022: big problems</li>
</ul></li>
</ul>
</section>
<section id="new-samples-syntax" class="slide level2">
<h2>New Samples Syntax</h2>
<p>Trying the same model with a different random number seed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a>modelCFA_samplesFail <span class="ot">=</span> modelCFA_stan<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb12-2"><a href=""></a>  <span class="at">data =</span> modelCFA_data,</span>
<span id="cb12-3"><a href=""></a>  <span class="at">seed =</span> <span class="dv">25102022</span>,</span>
<span id="cb12-4"><a href=""></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb12-5"><a href=""></a>  <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb12-6"><a href=""></a>  <span class="at">iter_warmup =</span> <span class="dv">2000</span>,</span>
<span id="cb12-7"><a href=""></a>  <span class="at">iter_sampling =</span> <span class="dv">2000</span></span>
<span id="cb12-8"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Convergence: FAIL</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.532298</code></pre>
</div>
</div>
</section>
<section id="why-convergence-failed" class="slide level2">
<h2>Why Convergence Failed</h2>
<p>The issue: <span class="math inline">\(\lambda_i \theta_p = (-\lambda_i)(-\theta_p)\)</span></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 10
   variable     mean median     sd    mad     q5   q95  rhat ess_bulk ess_tail
   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 mu[1]       2.37   2.37  0.0878 0.0887  2.23  2.51   1.00  1704.     3765. 
 2 mu[2]       1.96   1.96  0.0847 0.0833  1.82  2.10   1.00  1191.     2744. 
 3 mu[3]       1.88   1.88  0.0838 0.0844  1.74  2.02   1.00  1294.     3114. 
 4 mu[4]       2.01   2.01  0.0848 0.0835  1.87  2.15   1.00  1215.     3021. 
 5 mu[5]       1.99   1.99  0.0847 0.0843  1.85  2.13   1.00   911.     2148. 
 6 mu[6]       1.90   1.90  0.0765 0.0754  1.77  2.02   1.00   938.     2099. 
 7 mu[7]       1.73   1.73  0.0761 0.0755  1.60  1.85   1.00  1222.     2651. 
 8 mu[8]       1.85   1.84  0.0730 0.0729  1.72  1.96   1.00   927.     2010. 
 9 mu[9]       1.81   1.81  0.0870 0.0882  1.67  1.95   1.00  1268.     2962. 
10 mu[10]      1.52   1.52  0.0804 0.0818  1.39  1.65   1.00  1679.     3728. 
11 lambda[1]  -0.371 -0.705 0.647  0.127  -0.867 0.808  1.53     7.12     27.0
12 lambda[2]  -0.437 -0.837 0.760  0.120  -0.994 0.934  1.53     7.19     30.2
13 lambda[3]  -0.403 -0.770 0.701  0.121  -0.923 0.865  1.53     7.18     30.1
14 lambda[4]  -0.423 -0.810 0.736  0.121  -0.964 0.910  1.53     7.20     27.6
15 lambda[5]  -0.500 -0.966 0.868  0.109  -1.11  1.06   1.53     7.29     29.0
16 lambda[6]  -0.451 -0.872 0.783  0.101  -1.00  0.959  1.53     7.24     29.1
17 lambda[7]  -0.384 -0.736 0.667  0.108  -0.873 0.824  1.53     7.21     28.5
18 lambda[8]  -0.429 -0.829 0.743  0.0931 -0.951 0.908  1.53     7.24     30.0
19 lambda[9]  -0.431 -0.827 0.751  0.124  -0.984 0.929  1.53     7.18     30.4
20 lambda[10] -0.338 -0.641 0.588  0.117  -0.790 0.738  1.53     7.15     29.6
21 psi[1]      0.892  0.890 0.0500 0.0491  0.813 0.977  1.00 15991.     6212. 
22 psi[2]      0.734  0.733 0.0426 0.0417  0.667 0.807  1.00 14525.     6694. 
23 psi[3]      0.782  0.779 0.0448 0.0445  0.710 0.857  1.00 15772.     6470. 
24 psi[4]      0.757  0.755 0.0447 0.0436  0.688 0.835  1.00 14214.     6286. 
25 psi[5]      0.545  0.543 0.0375 0.0383  0.486 0.609  1.00  9175.     7161. 
26 psi[6]      0.505  0.504 0.0339 0.0338  0.452 0.563  1.00  9744.     6970. 
27 psi[7]      0.686  0.684 0.0408 0.0413  0.622 0.755  1.00 13685.     6203. 
28 psi[8]      0.480  0.478 0.0315 0.0309  0.429 0.533  1.00  9735.     6357. 
29 psi[9]      0.782  0.780 0.0459 0.0453  0.711 0.859  1.00 13962.     6709. 
30 psi[10]     0.840  0.838 0.0472 0.0467  0.766 0.922  1.00 15695.     6457. </code></pre>
</div>
</div>
</section>
<section id="posterior-trace-plots-of-lambda" class="slide level2">
<h2>Posterior Trace Plots of <span class="math inline">\(\lambda\)</span></h2>

<img data-src="04b_Modeling_Observed_Data_files/figure-revealjs/unnamed-chunk-28-1.png" width="960" class="r-stretch"></section>
<section id="posterior-density-plots-of-lambda" class="slide level2">
<h2>Posterior Density Plots of <span class="math inline">\(\lambda\)</span></h2>

<img data-src="04b_Modeling_Observed_Data_files/figure-revealjs/unnamed-chunk-29-1.png" width="960" class="r-stretch"></section>
<section id="examining-latent-variables" class="slide level2">
<h2>Examining Latent Variables</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 177 × 10
   variable     mean  median    sd   mad     q5   q95  rhat ess_bulk ess_tail
   &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 theta[1]  -0.0112 -0.0124 0.246 0.241 -0.420 0.388  1.00  5428.     4806. 
 2 theta[2]  -0.762  -1.41   1.35  0.402 -1.92  1.74   1.53     7.12     27.3
 3 theta[3]  -0.850  -1.58   1.49  0.420 -2.11  1.92   1.53     7.12     28.2
 4 theta[4]   0.461   0.827  0.847 0.387 -1.15  1.29   1.53     7.10     28.2
 5 theta[5]  -0.0161 -0.0148 0.249 0.252 -0.424 0.384  1.01   884.     4643. 
 6 theta[6]   0.486   0.871  0.892 0.395 -1.21  1.36   1.53     7.12     26.9
 7 theta[7]   0.170   0.238  0.390 0.368 -0.562 0.721  1.45     7.77     26.8
 8 theta[8]   0.0254  0.0241 0.247 0.248 -0.380 0.433  1.03   111.     3910. 
 9 theta[9]   0.389   0.674  0.730 0.396 -1.00  1.15   1.53     7.11     26.5
10 theta[10] -0.0232 -0.0241 0.247 0.249 -0.431 0.381  1.01   924.     4544. 
# ℹ 167 more rows</code></pre>
</div>
</div>
</section>
<section id="posterior-trace-plots-of-theta" class="slide level2">
<h2>Posterior Trace Plots of <span class="math inline">\(\theta\)</span></h2>

<img data-src="04b_Modeling_Observed_Data_files/figure-revealjs/unnamed-chunk-31-1.png" width="960" class="r-stretch"></section>
<section id="posterior-density-plots-of-theta" class="slide level2">
<h2>Posterior Density Plots of <span class="math inline">\(\theta\)</span></h2>

<img data-src="04b_Modeling_Observed_Data_files/figure-revealjs/unnamed-chunk-32-1.png" width="960" class="r-stretch"></section>
<section id="fixing-convergence" class="slide level2">
<h2>Fixing Convergence</h2>
<p>Stan allows starting values to be set via <code>cmdstanr</code></p>
<ul>
<li>Documentation is very lacking, but with some trial and a lot of error, I will show you how</li>
</ul>
<p>Alternatively:</p>
<ul>
<li>Restrict <span class="math inline">\(\lambda\)</span> to be positive
<ul>
<li>Truncates prior distribution with MVN</li>
</ul></li>
<li>Can also choose prior that has strictly positive range (like log-normal)</li>
<li>Note: The restriction on the space of <span class="math inline">\(\lambda\)</span> will not permit truely negative values
<ul>
<li>Not ideal as negative <span class="math inline">\(\lambda\)</span> values are informative as a problem with data</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a>parameters {</span>
<span id="cb16-2"><a href=""></a>  vector[nObs] theta;                <span class="sc">/</span><span class="er">/</span> the latent <span class="fu">variables</span> (one <span class="cf">for</span> each person)</span>
<span id="cb16-3"><a href=""></a>  vector[nItems] mu;                 <span class="sc">/</span><span class="er">/</span> the item <span class="fu">intercepts</span> (one <span class="cf">for</span> each item)</span>
<span id="cb16-4"><a href=""></a>  vector<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span>[nItems] lambda;             <span class="sc">/</span><span class="er">/</span> the factor loadings<span class="sc">/</span>item <span class="fu">discriminations</span> (one <span class="cf">for</span> each item)</span>
<span id="cb16-5"><a href=""></a>  vector<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span>[nItems] psi;       <span class="sc">/</span><span class="er">/</span> the unique standard <span class="fu">deviations</span> (one <span class="cf">for</span> each item)   </span>
<span id="cb16-6"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="setting-starting-values-in-stan" class="slide level2">
<h2>Setting Starting Values in Stan</h2>
<p>Starting values (initial values) are the first values used when an MCMC chain starts</p>
<ul>
<li>In Stan, by default, parameters are randomly started between -2 and 2
<ul>
<li>Bounded parameters are transformed so they are unbounded in the algorithm</li>
</ul></li>
<li>What we need:
<ul>
<li>Randomly start all <span class="math inline">\(\lambda\)</span> parameters so that they converge to the <span class="math inline">\(\lambda_i\theta_p\)</span> mode
<ul>
<li>As opposed to the <span class="math inline">\((-\lambda_i)(-\theta_p)\)</span> mode</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="cmdstanr-syntax-for-initial-values" class="slide level2">
<h2>cmdstanr Syntax for Initial Values</h2>
<p>Add the init option to the $sample() function of the <code>cmdstanr</code> object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a><span class="co"># set starting values for some of the parameters</span></span>
<span id="cb17-2"><a href=""></a>modelCFA_samples2fixed <span class="ot">=</span> modelCFA_stan<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb17-3"><a href=""></a>  <span class="at">data =</span> modelCFA_data,</span>
<span id="cb17-4"><a href=""></a>  <span class="at">seed =</span> <span class="dv">25102022</span>,</span>
<span id="cb17-5"><a href=""></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb17-6"><a href=""></a>  <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb17-7"><a href=""></a>  <span class="at">iter_warmup =</span> <span class="dv">2000</span>,</span>
<span id="cb17-8"><a href=""></a>  <span class="at">iter_sampling =</span> <span class="dv">2000</span>, </span>
<span id="cb17-9"><a href=""></a>  <span class="at">init =</span> <span class="cf">function</span>() <span class="fu">list</span>(<span class="at">lambda=</span><span class="fu">rnorm</span>(nItems, <span class="at">mean=</span><span class="dv">10</span>, <span class="at">sd=</span><span class="dv">2</span>))</span>
<span id="cb17-10"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The init option can be specified as a function, here, randomly starting each <span class="math inline">\(\lambda\)</span> following a normal distribution</p>
</section>
<section id="initialization-process" class="slide level2">
<h2>Initialization Process</h2>
<p>See the lecture R syntax for information on how to confirm starting values are set</p>
</section>
<section id="final-results-parameters" class="slide level2">
<h2>Final Results: Parameters</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.00472</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 10
   variable    mean median     sd    mad    q5   q95  rhat ess_bulk ess_tail
   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 mu[1]      2.37   2.36  0.0878 0.0863 2.22  2.51   1.00    1086.    2547.
 2 mu[2]      1.95   1.95  0.0857 0.0845 1.81  2.10   1.00     725.    1588.
 3 mu[3]      1.87   1.87  0.0862 0.0870 1.73  2.02   1.00     854.    1829.
 4 mu[4]      2.01   2.01  0.0868 0.0866 1.87  2.16   1.00     777.    1397.
 5 mu[5]      1.98   1.98  0.0874 0.0857 1.84  2.13   1.00     585.     980.
 6 mu[6]      1.89   1.89  0.0793 0.0788 1.76  2.02   1.00     609.    1139.
 7 mu[7]      1.72   1.72  0.0782 0.0761 1.59  1.85   1.00     770.    1520.
 8 mu[8]      1.84   1.84  0.0750 0.0755 1.72  1.96   1.00     580.    1062.
 9 mu[9]      1.81   1.81  0.0884 0.0874 1.66  1.95   1.00     796.    1728.
10 mu[10]     1.52   1.52  0.0825 0.0824 1.38  1.66   1.00    1122.    2205.
11 lambda[1]  0.737  0.734 0.0827 0.0811 0.605 0.876  1.00    3302.    4406.
12 lambda[2]  0.870  0.866 0.0767 0.0776 0.750 1.00   1.00    2181.    3811.
13 lambda[3]  0.802  0.799 0.0768 0.0775 0.679 0.930  1.00    2580.    4391.
14 lambda[4]  0.843  0.841 0.0767 0.0758 0.720 0.971  1.00    2282.    4093.
15 lambda[5]  0.997  0.994 0.0691 0.0696 0.887 1.12   1.00    1446.    2984.
16 lambda[6]  0.899  0.896 0.0636 0.0644 0.800 1.01   1.00    1464.    3098.
17 lambda[7]  0.765  0.763 0.0695 0.0680 0.654 0.883  1.00    2313.    3779.
18 lambda[8]  0.853  0.851 0.0609 0.0616 0.757 0.955  1.00    1547.    3327.
19 lambda[9]  0.861  0.858 0.0796 0.0777 0.734 0.995  1.00    2331.    4095.
20 lambda[10] 0.672  0.670 0.0771 0.0763 0.549 0.804  1.00    3427.    5018.
21 psi[1]     0.892  0.890 0.0503 0.0502 0.812 0.980  1.00   13357.    5746.
22 psi[2]     0.735  0.733 0.0437 0.0434 0.666 0.811  1.00   11126.    6092.
23 psi[3]     0.781  0.780 0.0452 0.0451 0.710 0.859  1.00   13015.    6448.
24 psi[4]     0.758  0.756 0.0441 0.0439 0.689 0.833  1.00   12527.    6555.
25 psi[5]     0.545  0.544 0.0368 0.0373 0.487 0.607  1.00    8108.    6781.
26 psi[6]     0.505  0.504 0.0341 0.0342 0.451 0.562  1.00    8063.    6345.
27 psi[7]     0.686  0.684 0.0396 0.0394 0.623 0.753  1.00   12978.    6088.
28 psi[8]     0.480  0.479 0.0314 0.0310 0.430 0.533  1.00    8821.    6431.
29 psi[9]     0.782  0.780 0.0462 0.0455 0.711 0.862  1.00   10379.    6070.
30 psi[10]    0.840  0.838 0.0467 0.0457 0.767 0.920  1.00   13767.    5702.</code></pre>
</div>
</div>
</section>
<section id="comparing-results" class="slide level2">
<h2>Comparing Results</h2>
<p>Plot of all parameters across both algorithm runs:</p>

<img data-src="04b_Modeling_Observed_Data_files/figure-revealjs/unnamed-chunk-36-1.png" width="960" class="r-stretch"><p>Correlation of all parameters across both algorithm runs:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9999964</code></pre>
</div>
</div>
</section>
<section id="section-4" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Wrapping Up</p>
</div>
</section>
<section id="wrapping-up" class="slide level2">
<h2>Wrapping Up</h2>
<p>Today, we showed how to model observed data using a normal distribution</p>
<ul>
<li>Assumptions of Confirmatory Factor Analysis
<ul>
<li>Not appropriate for our data</li>
<li>May not be appropriate for many data sets</li>
</ul></li>
<li>We will have to keep our loading/discrimination parameters positive to ensure each chain converges to the same posterior mode
<ul>
<li>This will continue through the next types of data</li>
</ul></li>
<li>Next up, categorical distributions for observed data
<ul>
<li>More appropriate for these data as they are discrete categorical responses</li>
</ul></li>
</ul>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p><a href="https://jonathantemplin.com/bayesian-psychometric-modeling-fall-2024/">https://jonathantemplin.com/bayesian-psychometric-modeling-fall-2024/</a></p>
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="04b_Modeling_Observed_Data_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="04b_Modeling_Observed_Data_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="04b_Modeling_Observed_Data_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="04b_Modeling_Observed_Data_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="04b_Modeling_Observed_Data_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="04b_Modeling_Observed_Data_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="04b_Modeling_Observed_Data_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="04b_Modeling_Observed_Data_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="04b_Modeling_Observed_Data_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="04b_Modeling_Observed_Data_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>