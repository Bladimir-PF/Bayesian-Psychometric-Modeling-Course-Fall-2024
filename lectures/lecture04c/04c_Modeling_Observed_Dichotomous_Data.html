<!DOCTYPE html>
<html lang="en"><head>
<script src="04c_Modeling_Observed_Dichotomous_Data_files/libs/clipboard/clipboard.min.js"></script>
<script src="04c_Modeling_Observed_Dichotomous_Data_files/libs/quarto-html/tabby.min.js"></script>
<script src="04c_Modeling_Observed_Dichotomous_Data_files/libs/quarto-html/popper.min.js"></script>
<script src="04c_Modeling_Observed_Dichotomous_Data_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="04c_Modeling_Observed_Dichotomous_Data_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="04c_Modeling_Observed_Dichotomous_Data_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="04c_Modeling_Observed_Dichotomous_Data_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="04c_Modeling_Observed_Dichotomous_Data_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.56">

  <meta name="author" content="Lecture 4c">
  <title>Generalized Measurement Models: Modeling Observed Dichotomous Data</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="04c_Modeling_Observed_Dichotomous_Data_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="04c_Modeling_Observed_Dichotomous_Data_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="04c_Modeling_Observed_Dichotomous_Data_files/libs/revealjs/dist/theme/quarto.css">
  <link href="04c_Modeling_Observed_Dichotomous_Data_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="04c_Modeling_Observed_Dichotomous_Data_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="04c_Modeling_Observed_Dichotomous_Data_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="04c_Modeling_Observed_Dichotomous_Data_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Generalized Measurement Models: Modeling Observed Dichotomous Data</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Lecture 4c 
</div>
</div>
</div>

</section>
<section id="todays-lecture-objectives" class="slide level2">
<h2>Today’s Lecture Objectives</h2>
<ol type="1">
<li>Show how to estimate unidimensional latent variable models with dichotomous data</li>
</ol>
<ol type="a">
<li>Also known as Item Response Theory (IRT) or Item Factor Analysis (IFA) models</li>
</ol>
<ol start="2" type="1">
<li>Show how to estimate different parameterizations of IRT/IFA models</li>
<li>Describe how to obtain IRT/IFA auxiliary statistics from Markov Chains</li>
<li>Show variations of various dichotomous-data models</li>
</ol>
</section>
<section id="example-data-conspiracy-theories" class="slide level2">
<h2>Example Data: Conspiracy Theories</h2>
<p>Today’s example is from a bootstrap resample of 177 undergraduate students at a large state university in the Midwest. The survey was a measure of 10 questions about their beliefs in various conspiracy theories that were being passed around the internet in the early 2010s. Additionally, gender was included in the survey. All items responses were on a 5- point Likert scale with:</p>
<ol type="1">
<li>Strongly Disagree</li>
<li>Disagree</li>
<li>Neither Agree or Disagree</li>
<li>Agree</li>
<li>Strongly Agree</li>
</ol>
<h4 id="please-note-the-purpose-of-this-survey-was-to-study-individual-beliefs-regarding-conspiracies.-the-questions-can-provoke-some-strong-emotions-given-the-world-we-live-in-currently.-all-questions-were-approved-by-university-irb-prior-to-their-use.">Please note, the purpose of this survey was to study individual beliefs regarding conspiracies. The questions can provoke some strong emotions given the world we live in currently. All questions were approved by university IRB prior to their use.</h4>
<p>Our purpose in using this instrument is to provide a context that we all may find relevant as many of these conspiracy theories are still prevalent today.</p>
</section>
<section id="conspiracy-theory-questions-1-5" class="slide level2">
<h2>Conspiracy Theory Questions 1-5</h2>
<p>Questions:</p>
<ol type="1">
<li>The U.S. invasion of Iraq was not part of a campaign to fight terrorism, but was driven by oil companies and Jews in the U.S. and Israel.</li>
<li>Certain U.S. government officials planned the attacks of September 11, 2001 because they wanted the United States to go to war in the Middle East.</li>
<li>President Barack Obama was not really born in the United States and does not have an authentic Hawaiian birth certificate.</li>
<li>The current financial crisis was secretly orchestrated by a small group of Wall Street bankers to extend the power of the Federal Reserve and further their control of the world’s economy.</li>
<li>Vapor trails left by aircraft are actually chemical agents deliberately sprayed in a clandestine program directed by government officials.</li>
</ol>
</section>
<section id="conspiracy-theory-questions-6-10" class="slide level2">
<h2>Conspiracy Theory Questions 6-10</h2>
<p>Questions:</p>
<ol start="6" type="1">
<li>Billionaire George Soros is behind a hidden plot to destabilize the American government, take control of the media, and put the world under his control.</li>
<li>The U.S. government is mandating the switch to compact fluorescent light bulbs because such lights make people more obedient and easier to control.</li>
<li>Government officials are covertly Building a 12-lane "NAFTA superhighway" that runs from Mexico to Canada through America’s heartland.</li>
<li>Government officials purposely developed and spread drugs like crack-cocaine and diseases like AIDS in order to destroy the African American community.</li>
<li>God sent Hurricane Katrina to punish America for its sins.</li>
</ol>
</section>
<section id="section" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>DON’T DO THIS WITH YOUR DATA</p>
</div>
</section>
<section id="making-our-data-dichotomous" class="slide level2">
<h2>Making Our Data Dichotomous</h2>
<p>To show dichotomous-data models with our data, we will arbitrarily dichotomize our item responses:</p>
<ul>
<li>0 == Response is Strongly Disagree or Disagree, or Neither</li>
<li>1 == Response is Agree, or Strongly Agree</li>
</ul>
<p>Now, we could argue that a “1” represents someone who agrees with a statement and a zero is someone who disagrees or is neutral</p>
<p>Note that this is only for teaching purposes, such dichotomization shouldn’t be done</p>
<ul>
<li>There are distributions for multinomial categories (we discuss these next week)</li>
<li>The results will reflect more of our choice for 0/1</li>
</ul>
<p>But, we must first learn dichotomous data models before we get to models for polytomous data</p>
</section>
<section id="examining-dichotomous-data" class="slide level2">
<h2>Examining Dichotomous Data</h2>
<p>Checking on one item (Item 1):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   
     1  2  3  4  5
  0 49 51 47  0  0
  1  0  0  0 23  7</code></pre>
</div>
</div>
<p>New item means:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> PolConsp1  PolConsp2  PolConsp3  PolConsp4  PolConsp5  PolConsp6  PolConsp7 
0.16949153 0.10169492 0.06779661 0.07909605 0.10734463 0.06214689 0.06214689 
 PolConsp8  PolConsp9 PolConsp10 
0.03389831 0.11299435 0.06214689 </code></pre>
</div>
</div>
<p>Note: these items have a relatively low proportion of people agreeing with each conspiracy statement</p>
<ul>
<li>Highest mean: .169</li>
<li>Lowest mean: .034</li>
</ul>
</section>
<section id="section-1" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Dichotomous Data Distribution: Bernoulli</p>
</div>
</section>
<section id="the-bernoulli-distribution" class="slide level2">
<h2>The Bernoulli Distribution</h2>
<p>The Bernoulli distribution is a one-trial version of the Binomial distribution</p>
<ul>
<li>Sample space (support) <span class="math inline">\(Y \in \{0, 1\}\)</span></li>
</ul>
<p>The probability mass function (pdf):</p>
<p><span class="math display">\[P(Y = y) = \pi^y\left(1-\pi\right)^{(1-y)}\]</span></p>
<p>The distribution has only one parameter: <span class="math inline">\(\pi\)</span> (the probability <span class="math inline">\(Y=1\)</span>)</p>
<ul>
<li>Mean of the distribution: <span class="math inline">\(E(Y) = \pi\)</span></li>
<li>Variance of the distribution: <span class="math inline">\(Var(Y) = \pi \left(1- \pi \right)\)</span></li>
</ul>
</section>
<section id="definition-dichotomous-vs.-binary" class="slide level2">
<h2>Definition: Dichotomous vs.&nbsp;Binary</h2>
<p>Note the definitions of some of the words for data with two values:</p>
<ul>
<li>Dichotomous: Taking two values (without numbers attached)</li>
<li>Binary: either zero or one (specifically: <span class="math inline">\(\{0,1 \}\)</span>)</li>
</ul>
<p>Therefore:</p>
<ul>
<li>Not all dichotomous variables are binary (i.e., <span class="math inline">\(\{2, 7\}\)</span> is a dichotomous variable)</li>
<li>All binary variables are dichotomous</li>
</ul>
<p>Finally:</p>
<ul>
<li>Bernoulli distributions are for binary variables</li>
<li>Most dichotomous variables can be recoded as binary variables without loss of model effects</li>
</ul>
</section>
<section id="models-with-bernoulli-distributions" class="slide level2">
<h2>Models with Bernoulli Distributions</h2>
<p>Generalized linear models using Bernoulli distributions put a linear model onto a transformation of the mean</p>
<ul>
<li>Link functions map the mean <span class="math inline">\(E(Y)\)</span> from its original range of <span class="math inline">\([0,1]\)</span> to <span class="math inline">\((-\infty, \infty)\)</span></li>
</ul>
<p>For an unconditional (empty) model, this is shown here:</p>
<p><span class="math display">\[f\left( E \left(Y \right) \right) = f(\pi)\]</span></p>
</section>
<section id="link-functions-for-bernoulli-distributions" class="slide level2">
<h2>Link Functions for Bernoulli Distributions</h2>
<p>Common choices for the link function (in latent variable models):</p>
<ul>
<li><p>Logit (or log odds): <span class="math display">\[f\left( \pi \right) = \log \left( \frac{\pi}{1-\pi} \right)\]</span></p></li>
<li><p>Probit: <span class="math display">\[f\left( \pi \right) = \Phi^{-1} \left( \pi \right) \]</span></p></li>
</ul>
<p>Where Phi is the inverse cumulative distribution of a standard normal distribution:</p>
<p><span class="math display">\[\Phi(Z) = \int_{-\infty}^Z \frac{1}{\sqrt{2\pi}} \exp \left( \frac{-x^2}{2} \right) dx\]</span></p>
</section>
<section id="less-common-link-functions" class="slide level2">
<h2>Less Common Link Functions</h2>
<p>In the generalized linear models literature, there are a number of different link functions:</p>
<ul>
<li>Log-log: <span class="math inline">\(f\left( \pi \right) = -\log \left( -\log \left( \pi \right) \right)\)</span></li>
<li>Complementary Log-Log: <span class="math inline">\(f\left( \pi \right) = \log \left( -\log \left( 1- \pi \right) \right)\)</span></li>
</ul>
<p>Most of these seldom appear in latent variable models</p>
<ul>
<li>Each has a slightly different curve shape</li>
</ul>
</section>
<section id="inverse-link-functions" class="slide level2">
<h2>Inverse Link Functions</h2>
<p>Our latent variable models will be defined on the scale of the link function</p>
<ul>
<li>Sometimes we wish to convert back to the scale of the data
<ul>
<li>Example: Test characteristic curves mapping <span class="math inline">\(\theta_p\)</span> onto an expected test score</li>
</ul></li>
</ul>
<p>For this, we need the inverse link function</p>
<ul>
<li><p>Logit (or log odds) link function: <span class="math display">\[logit \left(\pi\right)  = \log \left( \frac{\pi}{1-\pi} \right)\]</span></p></li>
<li><p>Logit (or log odds) inverse link function:</p></li>
</ul>
<p><span class="math display">\[\pi  = \frac{\exp \left(logit \left(\pi \right)\right)}{1+\exp \left(logit \left(\pi \right)\right)} = \frac{1}{1+\exp \left(-logit \left(\pi \right)\right)}  = \left( 1+\exp \left(-logit \left(\pi \right)\right)\right)^{-1}\]</span></p>
</section>
<section id="section-2" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Latent Variable Models with Bernoulli Distributions for Observed Variables</p>
</div>
</section>
<section id="latent-variable-models-with-bernoulli-distributions-for-observed-variables" class="slide level2">
<h2>Latent Variable Models with Bernoulli Distributions for Observed Variables</h2>
<p>We can finally define a latent variable model for binary responses using a Bernoulli distribution</p>
<ul>
<li>To start, we will use the logit link function</li>
<li>We will begin with the linear predictor we had from the normal distribution models (Confirmator factor analysis: <span class="math inline">\(\mu_i +\lambda_i\theta_p\)</span>)</li>
</ul>
<p>For an item <span class="math inline">\(i\)</span> and a person <span class="math inline">\(p\)</span>, the model becomes:</p>
<p><span class="math display">\[logit \left( P\left( Y_{pi}=1\right) \right) = \mu_i +\lambda_i\theta_p\]</span></p>
<ul>
<li>Note: the mean <span class="math inline">\(\pi_i\)</span> is replaced by <span class="math inline">\(P\left(Y_{pi} = 1 |\theta_p \right)\)</span>
<ul>
<li>This is the mean of the observed variable, conditional on <span class="math inline">\(\theta_p\)</span></li>
</ul></li>
<li>The item intercept is <span class="math inline">\(\mu_i\)</span>: The expected logit when <span class="math inline">\(\theta_p = 0\)</span></li>
<li>The item discrimination is <span class="math inline">\(\lambda_i\)</span>: The change in the logit for a one-unit increase in <span class="math inline">\(\theta_p\)</span></li>
</ul>
</section>
<section id="model-family-names" class="slide level2">
<h2>Model Family Names</h2>
<p>Depending on your field, the model from the previous slide can be called:</p>
<ul>
<li>The two-parameter logistic (2PL) model with slope/intercept parameterization</li>
<li>An item factor model</li>
</ul>
<p>These names reflect the terms given to the model in diverging literatures:</p>
<ul>
<li>2PL: Educational measurement
<ul>
<li>Birnbaum, A. (1968). Some Latent Trait Models and Their Use in Inferring an Examinee’s Ability. In F. M. Lord &amp; M. R. Novick (Eds.), Statistical Theories of Mental Test Scores (pp.&nbsp;397-424). Reading, MA: Addison-Wesley.</li>
</ul></li>
<li>Item factor analysis: Psychology
<ul>
<li>Christofferson, A.(1975). Factor analysis of dichotomous variables. Psychometrika , 40, 5-22.</li>
</ul></li>
</ul>
<p>Estimation methods are the largest difference between the two families</p>
</section>
<section id="differences-from-normal-distributions" class="slide level2">
<h2>Differences from Normal Distributions</h2>
<p>Recall our normal distribution models:</p>
<p><span class="math display">\[
\begin{array}{cc}
Y_{pi} = \mu_i + \lambda_i \theta_p  + e_{p,i}; &amp; e_{p,i} \sim N\left(0, \psi_i^2 \right) \\
\end{array}
\]</span></p>
<p>Compared to our Bernoulli distribution models:</p>
<p><span class="math display">\[logit \left( P\left( Y_{pi}=1\right) \right) = \mu_i +\lambda_i\theta_p\]</span></p>
<p>Differences:</p>
<ul>
<li>No residual (unique) variance <span class="math inline">\(\phi^2\)</span> in Bernoulli distribution
<ul>
<li>Only one parameter in distribution; variance is a function of the mean</li>
</ul></li>
<li>Identity link function in normal distribution: <span class="math inline">\(f(E(Y_{pi}|\theta_p)) = E(Y_{pi}|\theta_p)\)</span>
<ul>
<li>Model scale and data scale are the same</li>
</ul></li>
<li>Logit link function in Bernoulli distribution
<ul>
<li>Model scale is different from data scale</li>
</ul></li>
</ul>
</section>
<section id="from-model-scale-to-data-scale" class="slide level2">
<h2>From Model Scale to Data Scale</h2>
<p>Commonly, the IRT or IFA model is shown on the data scale (using the inverse link function):</p>
<p><span class="math display">\[P\left( Y_{pi}=1\right) = \frac{\exp \left(\mu_i +\lambda_i\theta_p \right)}{1+\exp \left(\mu_i +\lambda_i\theta_p \right)}\]</span></p>
<p>The core of the model (the terms in the exponent on the right-hand side) is the same</p>
<ul>
<li>Models are equivalent
<ul>
<li><span class="math inline">\(P\left( Y_{pi}=1\right)\)</span> is on the data scale</li>
<li><span class="math inline">\(logit \left( P\left( Y_{pi}=1\right) \right)\)</span> is on the model (link) scale</li>
</ul></li>
</ul>
</section>
<section id="modeling-all-data" class="slide level2">
<h2>Modeling All Data</h2>
<p>As with the normal distribution (CFA) models, we use the Bernoulli distribution for all observed variables:</p>
<p><span class="math display">\[
\begin{array}{c}
logit \left(Y_{p1} = 1 \right) = \mu_1 + \lambda_1 \theta_p  \\
logit \left(Y_{p2} = 1 \right) = \mu_2 + \lambda_2 \theta_p  \\  
logit \left(Y_{p3} = 1 \right) = \mu_3 + \lambda_3 \theta_p  \\  
logit \left(Y_{p4} = 1 \right) = \mu_4 + \lambda_4 \theta_p  \\  
logit \left(Y_{p5} = 1 \right) = \mu_5 + \lambda_5 \theta_p  \\  
logit \left(Y_{p6} = 1 \right) = \mu_6 + \lambda_6 \theta_p  \\  
logit \left(Y_{p7} = 1 \right) = \mu_7 + \lambda_7 \theta_p  \\  
logit \left(Y_{p8} = 1 \right) = \mu_8 + \lambda_8 \theta_p  \\
logit \left(Y_{p9} = 1 \right) = \mu_9 + \lambda_9 \theta_p  \\  
logit \left(Y_{p10} = 1 \right) = \mu_{10} + \lambda_{10} \theta_p  \\
\end{array}
\]</span></p>
</section>
<section id="measurement-model-analysis-steps" class="slide level2">
<h2>Measurement Model Analysis Steps</h2>
<ol type="1">
<li>Specify model</li>
<li>Specify scale identification method for latent variables</li>
<li>Estimate model</li>
<li>Examine model-data fit</li>
<li>Iterate between steps 1-4 until adequate fit is achieved</li>
</ol>
<h4 id="measurement-model-auxiliary-components">Measurement Model Auxiliary Components</h4>
<ol start="6" type="1">
<li>Score estimation (and secondary analyses with scores)</li>
<li>Item evaluation</li>
<li>Scale construction</li>
<li>Equating</li>
<li>Measurement invariance/differential item functioning</li>
</ol>
</section>
<section id="model-specification" class="slide level2">
<h2>Model Specification</h2>
<p>The set of equations on the previous slide formed step #1 of the Measurement Model Analysis Steps:</p>
<ol type="1">
<li>Specify Model</li>
</ol>
<p>The next step is:</p>
<ol start="2" type="1">
<li>Specify scale identification method for latent variables</li>
</ol>
<p>We will initially assume <span class="math inline">\(\theta_p \sim N(0,1)\)</span>, which allows us to estimate all item parameters of the model</p>
<ul>
<li>This is what we call a standardized latent variable
<ul>
<li>They are like Z-scores</li>
</ul></li>
</ul>
</section>
<section id="model-data-likelihood-functions" class="slide level2">
<h2>Model (Data) Likelihood Functions</h2>
<p>The specification of the model defines the model (data) likelihood function for each type of parameter</p>
<ul>
<li>To demonstrate, let’s examine the data likelihood for the factor loading for the first item <span class="math inline">\(\lambda_1\)</span></li>
</ul>
<p>The model (data) likelihood function can be defined conditional on all other parameter values (as in a block in an MCMC iteration)</p>
<ul>
<li>That is: hold <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\boldsymbol{\theta}\)</span> constant</li>
</ul>
<p>The likelihood is then:</p>
<p><span class="math display">\[f \left(Y_{p1} \mid \lambda_1 \right) = \prod_{p=1}^P \left( \pi_{p1} \right)^{Y_{p1}} \left(1- \pi_{p1} \right)^{1-Y_{p1}}\]</span></p>
</section>
<section id="model-data-log-likelihood-functions" class="slide level2">
<h2>Model (Data) Log Likelihood Functions</h2>
<p>As this number can be very small (making numerical precision an issue), we often take the log:</p>
<p><span class="math display">\[\log f \left(Y_{p1} \mid \lambda_1 \right) = \sum_{p=1}^P \log \left[ \left( \pi_{p1} \right)^{Y_{p1}} \left(1- \pi_{p1} \right)^{1-Y_{p1}}\right]\]</span></p>
<p>The key in the likelihood function is to substitute each person’s data-scale model for <span class="math inline">\(\pi_{p1}\)</span>:</p>
<p><span class="math display">\[ \pi_{p1} = \frac{\exp \left(\mu_1 +\lambda_1\theta_p \right)}{1+\exp \left(\mu_1 +\lambda_1\theta_p \right)} \]</span></p>
<p>Which then becomes:</p>
<p><span class="math display">\[\log f \left(Y_{p1} \mid \lambda_1 \right) = \sum_{p=1}^P \log \left[ \left( \frac{\exp \left(\mu_1 +\lambda_1\theta_p \right)}{1+\exp \left(\mu_1 +\lambda_1\theta_p \right)} \right)^{Y_{p1}} \left(1- \frac{\exp \left(\mu_1 +\lambda_1\theta_p \right)}{1+\exp \left(\mu_1 +\lambda_1\theta_p \right)} \right)^{1-Y_{p1}}\right]\]</span></p>
</section>
<section id="model-data-log-likelihood-functions-1" class="slide level2">
<h2>Model (Data) Log Likelihood Functions</h2>
<p>As an example for <span class="math inline">\(\lambda_1\)</span>:</p>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"></section>
<section id="model-data-log-likelihood-functions-for-theta_p" class="slide level2">
<h2>Model (Data) Log Likelihood Functions for <span class="math inline">\(\theta_p\)</span></h2>
<p>For each person, the same model (data) likelihood function is used</p>
<ul>
<li>Only now it varies across each item response</li>
<li>Example: Person 1</li>
</ul>
<p><span class="math display">\[f \left(Y_{1i} \mid \theta_1 \right) = \prod_{i=1}^I \left( \pi_{1i} \right)^{Y_{1i}} \left(1- \pi_{1i} \right)^{1-Y_{1i}}\]</span></p>
</section>
<section id="model-data-log-likelihood-functions-2" class="slide level2">
<h2>Model (Data) Log Likelihood Functions</h2>
<p>As an example for the log-likelihood for <span class="math inline">\(\theta_2\)</span>:</p>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-5-1.png" width="960" class="r-stretch"></section>
<section id="model-data-log-likelihood-functions-3" class="slide level2">
<h2>Model (Data) Log Likelihood Functions</h2>
<p>As an example for the log-likelihood for <span class="math inline">\(\theta_1\)</span>:</p>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section>
<section id="section-3" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Implementing Bernoulli Outcomes in Stan</p>
</div>
</section>
<section id="stans-model-block" class="slide level2">
<h2>Stan’s <code>model</code> Block</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a>model {</span>
<span id="cb3-2"><a href=""></a>  </span>
<span id="cb3-3"><a href=""></a>  lambda <span class="sc">~</span> <span class="fu">multi_normal</span>(meanLambda, covLambda); <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> item discrimination<span class="sc">/</span>factor loadings</span>
<span id="cb3-4"><a href=""></a>  mu <span class="sc">~</span> <span class="fu">multi_normal</span>(meanMu, covMu);             <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> item intercepts</span>
<span id="cb3-5"><a href=""></a>  </span>
<span id="cb3-6"><a href=""></a>  theta <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>);                         <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> latent <span class="fu">variable</span> (with mean<span class="sc">/</span>sd specified)</span>
<span id="cb3-7"><a href=""></a>  </span>
<span id="cb3-8"><a href=""></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb3-9"><a href=""></a>    Y[item] <span class="sc">~</span> <span class="fu">bernoulli_logit</span>(mu[item] <span class="sc">+</span> lambda[item]<span class="sc">*</span>theta);</span>
<span id="cb3-10"><a href=""></a>  }</span>
<span id="cb3-11"><a href=""></a>  </span>
<span id="cb3-12"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For logit models without lower/upper asymptote parameters, Stan has a convenient <code>bernoulli_logit()</code> function</p>
<ul>
<li>Automatically has the link function embedded</li>
<li>The catch: The data have to be defined as an integer</li>
</ul>
<p>Also, note that there are few differences from the normal outcomes models (CFA)</p>
<ul>
<li>No <span class="math inline">\(\psi\)</span> parameters</li>
</ul>
</section>
<section id="stans-parameters-block" class="slide level2">
<h2>Stan’s <code>parameters</code> Block</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a>parameters {</span>
<span id="cb4-2"><a href=""></a>  vector[nObs] theta;                <span class="sc">/</span><span class="er">/</span> the latent <span class="fu">variables</span> (one <span class="cf">for</span> each person)</span>
<span id="cb4-3"><a href=""></a>  vector[nItems] mu;                 <span class="sc">/</span><span class="er">/</span> the item <span class="fu">intercepts</span> (one <span class="cf">for</span> each item)</span>
<span id="cb4-4"><a href=""></a>  vector[nItems] lambda;             <span class="sc">/</span><span class="er">/</span> the factor loadings<span class="sc">/</span>item <span class="fu">discriminations</span> (one <span class="cf">for</span> each item)</span>
<span id="cb4-5"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Only change from normal outcomes (CFA) model:</p>
<ul>
<li>No <span class="math inline">\(\psi\)</span> parameters</li>
</ul>
</section>
<section id="stans-data-block" class="slide level2">
<h2>Stan’s <code>data {}</code> Block</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a>data {</span>
<span id="cb5-2"><a href=""></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> nObs;                            <span class="sc">/</span><span class="er">/</span> number of observations</span>
<span id="cb5-3"><a href=""></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> nItems;                          <span class="sc">/</span><span class="er">/</span> number of items</span>
<span id="cb5-4"><a href=""></a>  array[nItems, nObs] int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span>, upper<span class="ot">=</span><span class="dv">1</span><span class="sc">&gt;</span>  Y; <span class="sc">/</span><span class="er">/</span> item responses <span class="cf">in</span> an array</span>
<span id="cb5-5"><a href=""></a></span>
<span id="cb5-6"><a href=""></a>  vector[nItems] meanMu;             <span class="sc">/</span><span class="er">/</span> prior mean vector <span class="cf">for</span> intercept parameters</span>
<span id="cb5-7"><a href=""></a>  matrix[nItems, nItems] covMu;      <span class="sc">/</span><span class="er">/</span> prior covariance matrix <span class="cf">for</span> intercept parameters</span>
<span id="cb5-8"><a href=""></a>  </span>
<span id="cb5-9"><a href=""></a>  vector[nItems] meanLambda;         <span class="sc">/</span><span class="er">/</span> prior mean vector <span class="cf">for</span> discrimination parameters</span>
<span id="cb5-10"><a href=""></a>  matrix[nItems, nItems] covLambda;  <span class="sc">/</span><span class="er">/</span> prior covariance matrix <span class="cf">for</span> discrimination parameters</span>
<span id="cb5-11"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>One difference from normal outcomes model:</p>
<p><code>array[nItems, nObs] int&lt;lower=0, upper=1&gt;  Y;</code></p>
<ul>
<li>Arrays are types of matrices (with more than two dimensions possible)
<ul>
<li>Allows for different types of data (here Y are integers)
<ul>
<li>Integer-valued variables needed for <code>bernoulli_logit()</code> function</li>
</ul></li>
</ul></li>
<li>Arrays are row-major (meaning order of items and persons is switched)
<ul>
<li>Can define differently</li>
</ul></li>
</ul>
</section>
<section id="change-to-data-list-for-stan-import" class="slide level2">
<h2>Change to Data List for Stan Import</h2>
<p>The switch of items and observations in the <code>array</code> statement means the data imported have to be transposed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a>modelIRT_2PL_SI_data <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb6-2"><a href=""></a>  <span class="at">nObs =</span> nObs,</span>
<span id="cb6-3"><a href=""></a>  <span class="at">nItems =</span> nItems,</span>
<span id="cb6-4"><a href=""></a>  <span class="at">Y =</span> <span class="fu">t</span>(conspiracyItemsDichtomous), </span>
<span id="cb6-5"><a href=""></a>  <span class="at">meanMu =</span> muMeanVecHP,</span>
<span id="cb6-6"><a href=""></a>  <span class="at">covMu =</span> muCovarianceMatrixHP,</span>
<span id="cb6-7"><a href=""></a>  <span class="at">meanLambda =</span> lambdaMeanVecHP,</span>
<span id="cb6-8"><a href=""></a>  <span class="at">covLambda =</span> lambdaCovarianceMatrixHP</span>
<span id="cb6-9"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="running-the-model-in-stan" class="slide level2">
<h2>Running the Model In Stan</h2>
<p>The Stan program takes longer to run than in linear models:</p>
<ul>
<li>Number of parameters = 197
<ul>
<li>10 observed variables (with two item parameters each: <span class="math inline">\(\mu_i\)</span> and <span class="math inline">\(\lambda_i\)</span>)</li>
<li>177 latent variables (one for each person: 177 parameters)</li>
</ul></li>
<li>cmdstanr samples call:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a>modelIRT_2PL_SI_samples <span class="ot">=</span> modelIRT_2PL_SI_stan<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb7-2"><a href=""></a>  <span class="at">data =</span> modelIRT_2PL_SI_data,</span>
<span id="cb7-3"><a href=""></a>  <span class="at">seed =</span> <span class="dv">02112022</span>,</span>
<span id="cb7-4"><a href=""></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb7-5"><a href=""></a>  <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb7-6"><a href=""></a>  <span class="at">iter_warmup =</span> <span class="dv">5000</span>,</span>
<span id="cb7-7"><a href=""></a>  <span class="at">iter_sampling =</span> <span class="dv">5000</span>,</span>
<span id="cb7-8"><a href=""></a>  <span class="at">init =</span> <span class="cf">function</span>() <span class="fu">list</span>(<span class="at">lambda=</span><span class="fu">rnorm</span>(nItems, <span class="at">mean=</span><span class="dv">5</span>, <span class="at">sd=</span><span class="dv">1</span>))</span>
<span id="cb7-9"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Note: Typically, longer chains are needed for larger models like this</li>
<li>Note: Starting values added (mean of 5 is due to logit function limits)
<ul>
<li>Helps keep definition of parameters (stay away from opposite mode)</li>
<li>Too large of value can lead to NaN values (exceeding numerical precision)</li>
</ul></li>
</ul>
</section>
<section id="model-results" class="slide level2">
<h2>Model Results</h2>
<ul>
<li>Checking convergence with <span class="math inline">\(\hat{R}\)</span> (PSRF):</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.001433</code></pre>
</div>
</div>
<ul>
<li>Item Parameter Results:</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 10
   variable     mean median     sd    mad     q5    q95  rhat ess_bulk ess_tail
   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 mu[1]       -2.47  -2.42  0.471  0.444  -3.32  -1.80  1.00    5795.    7316.
 2 mu[2]       -4.62  -4.45  1.12   1.02   -6.70  -3.13  1.00    5777.    5633.
 3 mu[3]       -4.89  -4.70  1.20   1.08   -7.11  -3.30  1.00    6085.    6213.
 4 mu[4]       -7.09  -6.68  2.25   1.92  -11.2   -4.28  1.00    5266.    5366.
 5 mu[5]      -16.2  -12.5  11.2    6.65  -40.6   -5.98  1.00    3897.    4691.
 6 mu[6]       -6.72  -6.30  2.20   1.77  -10.7   -4.11  1.00    5036.    4318.
 7 mu[7]       -7.31  -6.81  2.56   1.96  -11.8   -4.42  1.00    3415.    2265.
 8 mu[8]      -34.6  -32.3  16.1   16.1   -64.6  -12.9   1.00    7159.    8583.
 9 mu[9]       -7.44  -6.97  2.45   2.03  -12.0   -4.49  1.00    5165.    4596.
10 mu[10]      -5.96  -5.65  1.76   1.46   -9.01  -3.83  1.00    4477.    4109.
11 lambda[1]    1.91   1.86  0.507  0.481   1.17   2.81  1.00    5252.    7170.
12 lambda[2]    3.23   3.09  0.978  0.891   1.90   5.04  1.00    4844.    5214.
13 lambda[3]    2.86   2.73  0.972  0.885   1.54   4.64  1.00    5341.    5791.
14 lambda[4]    4.87   4.55  1.77   1.53    2.65   8.17  1.00    4999.    4886.
15 lambda[5]   13.0    9.92  9.09   5.42    4.58  32.8   1.00    3691.    4604.
16 lambda[6]    4.20   3.90  1.67   1.38    2.18   7.18  1.00    4456.    4399.
17 lambda[7]    4.65   4.29  1.91   1.49    2.44   7.93  1.00    3250.    2200.
18 lambda[8]   21.6   20.1  10.4   10.3     7.64  40.8   1.00    6523.    8026.
19 lambda[9]    5.89   5.50  2.07   1.72    3.36   9.73  1.00    4727.    4113.
20 lambda[10]   3.61   3.40  1.35   1.14    1.93   5.94  1.00    4270.    3895.</code></pre>
</div>
</div>
</section>
<section id="modeling-strategy-vs.-didactic-strategy" class="slide level2">
<h2>Modeling Strategy vs.&nbsp;Didactic Strategy</h2>
<p>At this point, one should investigate model fit of the model we just ran</p>
<ul>
<li>If the model does not fit, then all model parameters could be biased
<ul>
<li>Both item parameters and person parameters (<span class="math inline">\(\theta_p\)</span>)</li>
</ul></li>
<li>Moreover, the uncertainty accompanying each parameter (the posterior standard deviation) may also be biased
<ul>
<li>Especially bad for psychometric models as we quantify reliaiblity with these numbers</li>
</ul></li>
</ul>
<p>But, to teach generalized measurement models, we will first talk about differing models for observed data</p>
<ul>
<li>Different distributions</li>
<li>Different parameterizations across the different distributions</li>
</ul>
</section>
<section id="investigating-item-parameters" class="slide level2">
<h2>Investigating Item Parameters</h2>
<p>One plot that can help provide information about the item parameters is the item characteristic curve (ICC)</p>
<ul>
<li>The ICC is the plot of the expected value of the response conditional on the value of the latent traits, for a range of latent trait values</li>
</ul>
<p><span class="math display">\[E \left(Y_{pi} \mid \theta_p \right) = \frac{\exp \left(\mu_{i} +\lambda_{i}\theta_p \right)}{1+\exp \left(\mu_{i} +\lambda_{i}\theta_p \right)}  \]</span></p>
<ul>
<li>Because we have sampled values for each parameter, we can plot one ICC for each posterior draw</li>
</ul>
</section>
<section id="posterior-icc-plots" class="slide level2">
<h2>Posterior ICC Plots</h2>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"></section>
<section id="investigating-the-item-parameters" class="slide level2">
<h2>Investigating the Item Parameters</h2>
<p>Trace plots for <span class="math inline">\(\mu_i\)</span></p>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section>
<section id="investigating-the-item-parameters-1" class="slide level2">
<h2>Investigating the Item Parameters</h2>
<p>Density plots for <span class="math inline">\(\mu_i\)</span></p>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-16-1.png" width="960" class="r-stretch"></section>
<section id="investigating-the-item-parameters-2" class="slide level2">
<h2>Investigating the Item Parameters</h2>
<p>Trace plots for <span class="math inline">\(\lambda_i\)</span></p>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-17-1.png" width="960" class="r-stretch"></section>
<section id="investigating-the-item-parameters-3" class="slide level2">
<h2>Investigating the Item Parameters</h2>
<p>Density plots for <span class="math inline">\(\lambda_i\)</span></p>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-18-1.png" width="960" class="r-stretch"></section>
<section id="investigating-the-item-parameters-4" class="slide level2">
<h2>Investigating the Item Parameters</h2>
<p>Bivariate plots for <span class="math inline">\(\mu_i\)</span> and <span class="math inline">\(\lambda_i\)</span></p>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-19-1.png" width="960" class="r-stretch"></section>
<section id="investigating-the-latent-variables" class="slide level2">
<h2>Investigating the Latent Variables</h2>
<p>The estimated latent variables are then:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 177 × 10
    variable     mean median    sd   mad      q5   q95  rhat ess_bulk ess_tail
    &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
  1 theta[1]   -0.420 -0.351 0.771 0.786 -1.79   0.713  1.00   20783.   13381.
  2 theta[2]    1.35   1.35  0.195 0.194  1.04   1.68   1.00    3182.    7438.
  3 theta[3]    1.59   1.59  0.196 0.190  1.28   1.92   1.00    2920.    6731.
  4 theta[4]   -0.431 -0.362 0.788 0.812 -1.84   0.731  1.00   21364.   13898.
  5 theta[5]   -0.417 -0.347 0.770 0.788 -1.78   0.723  1.00   20033.   13403.
  6 theta[6]   -0.413 -0.335 0.777 0.800 -1.80   0.727  1.00   21656.   13717.
  7 theta[7]    0.342  0.423 0.535 0.501 -0.662  1.06   1.00   12348.    8537.
  8 theta[8]    0.599  0.668 0.431 0.392 -0.211  1.17   1.00   11272.    9547.
  9 theta[9]   -0.424 -0.357 0.779 0.796 -1.82   0.721  1.00   21114.   12838.
 10 theta[10]  -0.414 -0.343 0.770 0.792 -1.78   0.725  1.00   22522.   13164.
 11 theta[11]  -0.412 -0.342 0.773 0.786 -1.81   0.729  1.00   21329.   13979.
 12 theta[12]  -0.429 -0.354 0.785 0.794 -1.84   0.723  1.00   20081.   12769.
 13 theta[13]  -0.418 -0.353 0.767 0.798 -1.78   0.715  1.00   19474.   14221.
 14 theta[14]  -0.435 -0.358 0.787 0.797 -1.84   0.727  1.00   19625.   13297.
 15 theta[15]  -0.420 -0.352 0.779 0.799 -1.81   0.729  1.00   20652.   12989.
 16 theta[16]  -0.415 -0.349 0.773 0.791 -1.79   0.721  1.00   21160.   14397.
 17 theta[17]  -0.407 -0.337 0.774 0.790 -1.79   0.727  1.00   19561.   13413.
 18 theta[18]  -0.429 -0.357 0.783 0.788 -1.84   0.732  1.00   19854.   13088.
 19 theta[19]   1.22   1.22  0.205 0.198  0.888  1.56   1.00    3823.    7971.
 20 theta[20]  -0.423 -0.342 0.781 0.784 -1.82   0.732  1.00   19941.   13031.
 21 theta[21]  -0.416 -0.346 0.775 0.786 -1.81   0.728  1.00   20877.   13434.
 22 theta[22]  -0.416 -0.347 0.778 0.795 -1.81   0.725  1.00   20171.   13306.
 23 theta[23]  -0.429 -0.362 0.785 0.809 -1.82   0.724  1.00   19814.   13741.
 24 theta[24]  -0.423 -0.354 0.778 0.798 -1.83   0.717  1.00   22286.   14546.
 25 theta[25]   0.344  0.428 0.535 0.504 -0.655  1.06   1.00   13811.   10846.
 26 theta[26]   1.11   1.13  0.214 0.202  0.746  1.45   1.00    5593.    9923.
 27 theta[27]   0.822  0.868 0.325 0.290  0.222  1.27   1.00    8655.    8813.
 28 theta[28]  -0.419 -0.350 0.775 0.799 -1.80   0.727  1.00   19538.   11971.
 29 theta[29]   0.926  0.961 0.291 0.262  0.397  1.33   1.00    7099.    8771.
 30 theta[30]   1.40   1.39  0.182 0.179  1.11   1.70   1.00    3588.    7322.
 31 theta[31]  -0.422 -0.355 0.774 0.784 -1.79   0.730  1.00   22466.   13565.
 32 theta[32]  -0.429 -0.355 0.783 0.804 -1.83   0.726  1.00   19569.   12776.
 33 theta[33]  -0.409 -0.342 0.772 0.801 -1.79   0.727  1.00   21300.   12568.
 34 theta[34]  -0.410 -0.345 0.768 0.784 -1.78   0.727  1.00   22098.   13575.
 35 theta[35]  -0.426 -0.360 0.776 0.786 -1.83   0.725  1.00   20465.   13760.
 36 theta[36]  -0.418 -0.344 0.777 0.796 -1.82   0.718  1.00   19897.   13170.
 37 theta[37]  -0.409 -0.342 0.773 0.796 -1.80   0.725  1.00   20395.   13962.
 38 theta[38]  -0.413 -0.354 0.768 0.801 -1.76   0.722  1.00   20839.   13939.
 39 theta[39]  -0.416 -0.346 0.774 0.796 -1.80   0.726  1.00   21434.   12542.
 40 theta[40]  -0.420 -0.347 0.781 0.795 -1.82   0.735  1.00   20794.   12927.
 41 theta[41]  -0.420 -0.340 0.787 0.799 -1.83   0.732  1.00   20588.   12991.
 42 theta[42]  -0.411 -0.340 0.775 0.792 -1.80   0.720  1.00   18908.   12708.
 43 theta[43]  -0.414 -0.350 0.764 0.792 -1.79   0.720  1.00   21630.   14220.
 44 theta[44]  -0.422 -0.356 0.778 0.804 -1.79   0.728  1.00   21161.   13793.
 45 theta[45]   1.14   1.16  0.232 0.214  0.732  1.48   1.00    5057.    7559.
 46 theta[46]  -0.410 -0.346 0.761 0.776 -1.76   0.712  1.00   21832.   14102.
 47 theta[47]  -0.416 -0.349 0.781 0.803 -1.80   0.734  1.00   22773.   13310.
 48 theta[48]  -0.427 -0.356 0.792 0.817 -1.83   0.730  1.00   20060.   12502.
 49 theta[49]  -0.420 -0.355 0.771 0.790 -1.79   0.724  1.00   21413.   14174.
 50 theta[50]   0.929  0.961 0.286 0.262  0.405  1.33   1.00    6783.   10240.
 51 theta[51]  -0.419 -0.350 0.780 0.797 -1.80   0.724  1.00   20889.   12957.
 52 theta[52]  -0.426 -0.354 0.783 0.795 -1.83   0.718  1.00   19915.   13034.
 53 theta[53]  -0.414 -0.341 0.776 0.793 -1.80   0.734  1.00   21148.   13510.
 54 theta[54]  -0.423 -0.358 0.774 0.790 -1.81   0.722  1.00   21676.   14095.
 55 theta[55]  -0.416 -0.346 0.773 0.796 -1.80   0.721  1.00   21946.   13882.
 56 theta[56]  -0.419 -0.360 0.764 0.794 -1.77   0.716  1.00   20712.   14305.
 57 theta[57]  -0.416 -0.345 0.772 0.783 -1.81   0.710  1.00   21214.   14175.
 58 theta[58]  -0.418 -0.349 0.777 0.790 -1.82   0.722  1.00   20351.   13097.
 59 theta[59]   0.334  0.422 0.544 0.506 -0.684  1.06   1.00   13140.   10067.
 60 theta[60]  -0.409 -0.341 0.770 0.791 -1.78   0.723  1.00   20539.   13503.
 61 theta[61]   1.25   1.26  0.201 0.191  0.917  1.57   1.00    4316.    8558.
 62 theta[62]  -0.421 -0.346 0.777 0.787 -1.82   0.728  1.00   20480.   13521.
 63 theta[63]  -0.421 -0.349 0.782 0.803 -1.81   0.727  1.00   20151.   12810.
 64 theta[64]   1.11   1.12  0.215 0.200  0.746  1.44   1.00    5496.    9175.
 65 theta[65]  -0.414 -0.337 0.770 0.787 -1.80   0.719  1.00   21495.   13807.
 66 theta[66]  -0.421 -0.347 0.781 0.789 -1.84   0.727  1.00   20729.   12513.
 67 theta[67]  -0.419 -0.351 0.768 0.790 -1.79   0.717  1.00   20900.   14178.
 68 theta[68]  -0.416 -0.345 0.774 0.788 -1.80   0.725  1.00   21483.   14021.
 69 theta[69]  -0.411 -0.337 0.772 0.785 -1.79   0.726  1.00   20471.   13401.
 70 theta[70]  -0.421 -0.349 0.771 0.778 -1.80   0.713  1.00   21923.   13389.
 71 theta[71]  -0.425 -0.358 0.778 0.788 -1.81   0.727  1.00   21176.   13630.
 72 theta[72]   1.31   1.31  0.187 0.179  0.999  1.61   1.00    4022.    7963.
 73 theta[73]  -0.427 -0.358 0.778 0.789 -1.82   0.724  1.00   19174.   13065.
 74 theta[74]  -0.419 -0.346 0.785 0.807 -1.83   0.739  1.00   20558.   12539.
 75 theta[75]  -0.418 -0.352 0.781 0.794 -1.80   0.738  1.00   20161.   12711.
 76 theta[76]   2.18   2.14  0.364 0.346  1.66   2.84   1.00    6322.    9369.
 77 theta[77]  -0.423 -0.355 0.778 0.797 -1.80   0.725  1.00   20393.   12832.
 78 theta[78]   0.822  0.867 0.325 0.289  0.224  1.27   1.00   10758.    9795.
 79 theta[79]   1.22   1.22  0.205 0.201  0.886  1.56   1.00    4047.    8640.
 80 theta[80]  -0.430 -0.358 0.774 0.784 -1.81   0.719  1.00   20308.   12851.
 81 theta[81]  -0.413 -0.339 0.775 0.778 -1.80   0.722  1.00   19823.   13190.
 82 theta[82]  -0.417 -0.344 0.776 0.786 -1.81   0.723  1.00   19247.   13931.
 83 theta[83]  -0.417 -0.348 0.772 0.782 -1.79   0.728  1.00   20113.   13134.
 84 theta[84]   1.48   1.48  0.180 0.177  1.19   1.78   1.00    3080.    6847.
 85 theta[85]   0.595  0.667 0.441 0.395 -0.223  1.17   1.00   11378.    9456.
 86 theta[86]  -0.422 -0.345 0.780 0.795 -1.82   0.720  1.00   20303.   13340.
 87 theta[87]   0.533  0.613 0.473 0.431 -0.351  1.15   1.00   10694.   10006.
 88 theta[88]  -0.425 -0.348 0.781 0.800 -1.81   0.726  1.00   22139.   14473.
 89 theta[89]  -0.422 -0.349 0.782 0.804 -1.82   0.725  1.00   20241.   13501.
 90 theta[90]   0.342  0.423 0.538 0.512 -0.665  1.06   1.00   15128.   10817.
 91 theta[91]  -0.421 -0.355 0.772 0.801 -1.79   0.720  1.00   20192.   13873.
 92 theta[92]   1.24   1.25  0.201 0.188  0.903  1.55   1.00    4580.    7859.
 93 theta[93]  -0.417 -0.345 0.769 0.776 -1.81   0.713  1.00   19870.   13018.
 94 theta[94]   1.84   1.81  0.248 0.237  1.47   2.27   1.00    3352.    6069.
 95 theta[95]   1.42   1.42  0.180 0.176  1.13   1.72   1.00    3567.    7795.
 96 theta[96]  -0.413 -0.344 0.768 0.788 -1.79   0.730  1.00   19556.   14074.
 97 theta[97]  -0.421 -0.347 0.782 0.797 -1.81   0.728  1.00   19686.   12504.
 98 theta[98]  -0.423 -0.354 0.780 0.795 -1.81   0.737  1.00   21712.   14171.
 99 theta[99]  -0.421 -0.358 0.776 0.798 -1.80   0.736  1.00   20766.   13254.
100 theta[100] -0.416 -0.348 0.771 0.784 -1.80   0.721  1.00   20017.   12783.
101 theta[101] -0.424 -0.355 0.782 0.802 -1.82   0.730  1.00   20247.   13195.
102 theta[102]  1.76   1.75  0.228 0.216  1.42   2.17   1.00    3037.    5728.
103 theta[103] -0.413 -0.343 0.781 0.803 -1.80   0.723  1.00   19559.   12350.
104 theta[104]  1.43   1.43  0.178 0.175  1.15   1.73   1.00    3292.    6281.
105 theta[105] -0.418 -0.343 0.775 0.788 -1.81   0.723  1.00   20967.   13189.
106 theta[106]  0.910  0.947 0.301 0.273  0.362  1.33   1.00    7128.    9798.
107 theta[107]  1.48   1.48  0.179 0.175  1.19   1.78   1.00    3167.    7218.
108 theta[108]  0.345  0.435 0.534 0.494 -0.658  1.05   1.00   13326.   10502.
109 theta[109] -0.417 -0.351 0.779 0.798 -1.82   0.734  1.00   20777.   13645.
110 theta[110] -0.414 -0.339 0.776 0.795 -1.80   0.720  1.00   21418.   13344.
111 theta[111] -0.426 -0.360 0.777 0.801 -1.80   0.726  1.00   21695.   13511.
112 theta[112]  0.349  0.429 0.530 0.502 -0.659  1.06   1.00   14865.   11529.
113 theta[113] -0.415 -0.344 0.772 0.789 -1.80   0.708  1.00   20190.   13851.
114 theta[114] -0.416 -0.345 0.780 0.799 -1.81   0.731  1.00   20961.   13772.
115 theta[115]  1.43   1.43  0.179 0.177  1.14   1.73   1.00    3263.    7244.
116 theta[116] -0.414 -0.336 0.779 0.786 -1.82   0.725  1.00   19616.   13275.
117 theta[117] -0.418 -0.351 0.773 0.791 -1.80   0.726  1.00   19883.   13387.
118 theta[118] -0.418 -0.347 0.774 0.787 -1.81   0.714  1.00   19558.   13508.
119 theta[119] -0.416 -0.337 0.776 0.785 -1.80   0.720  1.00   21102.   13600.
120 theta[120] -0.429 -0.359 0.782 0.788 -1.81   0.723  1.00   19769.   12640.
121 theta[121]  0.708  0.770 0.400 0.360 -0.0470 1.24   1.00    7585.    9797.
122 theta[122]  0.345  0.427 0.533 0.501 -0.648  1.07   1.00   14526.   11034.
123 theta[123] -0.423 -0.352 0.773 0.787 -1.80   0.721  1.00   21452.   12928.
124 theta[124] -0.424 -0.354 0.772 0.798 -1.82   0.704  1.00   19607.   13302.
125 theta[125] -0.416 -0.345 0.776 0.800 -1.79   0.723  1.00   20154.   12739.
126 theta[126]  0.349  0.432 0.531 0.498 -0.635  1.07   1.00   13866.   12153.
127 theta[127]  0.914  0.952 0.296 0.267  0.384  1.33   1.00    7002.    9222.
128 theta[128] -0.415 -0.339 0.778 0.790 -1.81   0.730  1.00   20539.   12753.
129 theta[129] -0.419 -0.354 0.770 0.795 -1.78   0.719  1.00   21300.   13960.
130 theta[130]  1.71   1.70  0.209 0.201  1.39   2.07   1.00    2876.    5674.
131 theta[131]  0.340  0.431 0.543 0.506 -0.697  1.06   1.00   14162.   11074.
132 theta[132]  1.42   1.42  0.180 0.176  1.14   1.73   1.00    3603.    7466.
133 theta[133] -0.423 -0.344 0.782 0.801 -1.82   0.722  1.00   21124.   13975.
134 theta[134]  1.84   1.82  0.251 0.235  1.47   2.28   1.00    3169.    5375.
135 theta[135] -0.409 -0.340 0.767 0.785 -1.77   0.722  1.00   20861.   13054.
136 theta[136] -0.422 -0.350 0.771 0.784 -1.82   0.709  1.00   20578.   13454.
137 theta[137] -0.416 -0.344 0.777 0.794 -1.80   0.714  1.00   21015.   13067.
138 theta[138] -0.407 -0.341 0.770 0.789 -1.78   0.724  1.00   20648.   13361.
139 theta[139] -0.416 -0.350 0.769 0.790 -1.77   0.722  1.00   20134.   13585.
140 theta[140]  0.602  0.677 0.432 0.391 -0.212  1.17   1.00   11808.   10739.
141 theta[141] -0.413 -0.345 0.765 0.776 -1.79   0.717  1.00   19442.   12671.
142 theta[142] -0.417 -0.346 0.766 0.780 -1.79   0.710  1.00   20667.   12619.
143 theta[143] -0.415 -0.346 0.774 0.797 -1.80   0.719  1.00   20716.   14050.
144 theta[144] -0.421 -0.356 0.770 0.782 -1.78   0.720  1.00   18618.   12572.
145 theta[145] -0.424 -0.362 0.775 0.789 -1.81   0.729  1.00   20210.   13635.
146 theta[146] -0.419 -0.349 0.782 0.799 -1.82   0.727  1.00   19285.   13375.
147 theta[147] -0.414 -0.343 0.770 0.786 -1.78   0.721  1.00   19737.   13861.
148 theta[148]  1.24   1.23  0.194 0.189  0.922  1.56   1.00    4044.    7875.
149 theta[149] -0.414 -0.344 0.765 0.783 -1.78   0.708  1.00   21842.   14098.
150 theta[150] -0.420 -0.351 0.779 0.792 -1.82   0.722  1.00   19798.   12686.
151 theta[151]  0.343  0.429 0.541 0.503 -0.691  1.06   1.00   13091.    9706.
152 theta[152] -0.414 -0.337 0.779 0.795 -1.80   0.732  1.00   22454.   14411.
153 theta[153]  1.37   1.37  0.181 0.178  1.08   1.67   1.00    3723.    7054.
154 theta[154] -0.421 -0.352 0.771 0.797 -1.79   0.717  1.00   20921.   13123.
155 theta[155] -0.432 -0.359 0.786 0.806 -1.84   0.712  1.00   20730.   13044.
156 theta[156] -0.416 -0.345 0.778 0.787 -1.81   0.723  1.00   21608.   12990.
157 theta[157] -0.411 -0.330 0.769 0.775 -1.80   0.721  1.00   21002.   13019.
158 theta[158] -0.416 -0.345 0.773 0.799 -1.80   0.719  1.00   20998.   13331.
159 theta[159]  1.07   1.11  0.282 0.245  0.556  1.45   1.00    4695.    7645.
160 theta[160] -0.420 -0.353 0.780 0.804 -1.81   0.724  1.00   20506.   13503.
161 theta[161]  0.891  0.927 0.300 0.271  0.342  1.32   1.00    7554.    9668.
162 theta[162]  0.536  0.614 0.474 0.429 -0.356  1.16   1.00   10687.   10635.
163 theta[163] -0.418 -0.343 0.776 0.797 -1.81   0.723  1.00   20599.   12970.
164 theta[164] -0.409 -0.337 0.771 0.788 -1.77   0.726  1.00   20860.   13108.
165 theta[165]  0.930  0.962 0.283 0.258  0.411  1.33   1.00    7169.    9271.
166 theta[166] -0.420 -0.344 0.768 0.777 -1.80   0.715  1.00   19350.   13236.
167 theta[167] -0.411 -0.343 0.775 0.786 -1.79   0.731  1.00   21571.   13049.
168 theta[168]  1.11   1.12  0.214 0.200  0.747  1.44   1.00    5212.    8897.
169 theta[169] -0.415 -0.347 0.779 0.802 -1.79   0.731  1.00   20723.   13212.
170 theta[170] -0.423 -0.346 0.791 0.803 -1.84   0.736  1.00   19021.   12910.
171 theta[171]  0.861  0.906 0.320 0.281  0.264  1.30   1.00    8257.    9584.
172 theta[172] -0.413 -0.346 0.775 0.799 -1.79   0.721  1.00   19206.   13794.
173 theta[173] -0.422 -0.351 0.779 0.804 -1.81   0.717  1.00   20297.   13419.
174 theta[174] -0.416 -0.343 0.775 0.791 -1.80   0.718  1.00   20261.   12518.
175 theta[175] -0.425 -0.357 0.780 0.796 -1.83   0.705  1.00   19844.   12986.
176 theta[176] -0.433 -0.362 0.779 0.796 -1.82   0.714  1.00   20706.   13462.
177 theta[177] -0.417 -0.342 0.774 0.786 -1.80   0.722  1.00   20767.   14153.</code></pre>
</div>
</div>
</section>
<section id="eap-estimates-of-latent-variables" class="slide level2">
<h2>EAP Estimates of Latent Variables</h2>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-21-1.png" width="960" class="r-stretch"></section>
<section id="density-of-eap-estimates" class="slide level2">
<h2>Density of EAP Estimates</h2>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-22-1.png" width="960" class="r-stretch"></section>
<section id="comparing-two-posterior-distributions" class="slide level2">
<h2>Comparing Two Posterior Distributions</h2>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-23-1.png" width="960" class="r-stretch"></section>
<section id="comparing-eap-estimates-with-posterior-sds" class="slide level2">
<h2>Comparing EAP Estimates with Posterior SDs</h2>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-24-1.png" width="960" class="r-stretch"></section>
<section id="comparing-eap-estimates-with-sum-score" class="slide level2">
<h2>Comparing EAP Estimates with Sum Score</h2>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-25-1.png" width="960" class="r-stretch"></section>
<section id="section-4" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Discrimination/Difficulty Parameterization</p>
</div>
</section>
<section id="discriminationdifficulty-parameterization" class="slide level2">
<h2>Discrimination/Difficulty Parameterization</h2>
<p>The slope/intercept form is used in many model families:</p>
<ul>
<li>Confirmatory factor analysis</li>
<li>Item factor analysis</li>
<li>Multidimensional item response theory</li>
</ul>
<p>In educational measurement, a more common form of the model is discrimination/difficulty:</p>
<p><span class="math display">\[logit \left( P\left( Y_{pi}=1 \mid \theta_p \right) \right) = a_i\left(\theta_p - b_i\right)\]</span></p>
<p>More commonly, this is expressed on the data scale: <span class="math display">\[P\left( Y_{pi}=1 \mid \theta_p \right) = \frac{\exp \left( a_i\left(\theta_p - b_i\right) \right)}{1+\exp \left(a_i\left(\theta_p - b_i\right) \right)} \]</span></p>
</section>
<section id="comparisons-of-parameterizations" class="slide level2">
<h2>Comparisons of Parameterizations</h2>
<p>We’ve mentioned before there is a one-one relationship between the models:</p>
<p><span class="math display">\[a_i\left(\theta_p - b_i\right) = -a_i b_i + a_i\theta_p = \mu_i + \lambda_i\theta_p\]</span> Where:</p>
<ul>
<li><span class="math inline">\(\mu_i = -a_ib_i\)</span></li>
<li><span class="math inline">\(\lambda_i = a_i\)</span></li>
</ul>
<p>Alternatively:</p>
<ul>
<li><span class="math inline">\(b_i = -\frac{\mu_i}{a_i}\)</span></li>
<li><span class="math inline">\(a_i = \lambda_i\)</span></li>
</ul>
</section>
<section id="calculating-discriminationdifficulty-parameters-in-generated-quantities" class="slide level2">
<h2>Calculating Discrimination/Difficulty Parameters in Generated Quantities</h2>
<p>We can calculate one parameterization from the other using Stan’s generated quantities:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a>generated quantities{</span>
<span id="cb11-2"><a href=""></a>  vector[nItems] a;</span>
<span id="cb11-3"><a href=""></a>  vector[nItems] b;</span>
<span id="cb11-4"><a href=""></a>  </span>
<span id="cb11-5"><a href=""></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb11-6"><a href=""></a>    a[item] <span class="ot">=</span> lambda[item];</span>
<span id="cb11-7"><a href=""></a>    b[item] <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>mu[item]<span class="sc">/</span>lambda[item];</span>
<span id="cb11-8"><a href=""></a>  }</span>
<span id="cb11-9"><a href=""></a>  </span>
<span id="cb11-10"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="discriminationdifficulty-parameter-estimates" class="slide level2">
<h2>Discrimination/Difficulty Parameter Estimates</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 10
   variable  mean median     sd    mad    q5   q95  rhat ess_bulk ess_tail
   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 a[1]      1.90   1.85  0.497  0.475  1.16  2.79  1.00    5014.    6030.
 2 a[2]      3.21   3.07  0.993  0.887  1.88  5.03  1.00    4973.    4384.
 3 a[3]      2.88   2.73  1.01   0.895  1.54  4.75  1.00    3794.    4924.
 4 a[4]      4.87   4.54  1.79   1.54   2.64  8.15  1.00    4145.    5161.
 5 a[5]     13.1    9.91  9.43   5.49   4.57 33.1   1.00    2954.    3607.
 6 a[6]      4.20   3.89  1.67   1.39   2.16  7.14  1.00    3541.    3780.
 7 a[7]      4.64   4.31  1.88   1.48   2.44  7.85  1.00    4063.    3651.
 8 a[8]     21.8   20.2  10.6   10.5    7.47 41.8   1.00    6391.    8311.
 9 a[9]      5.86   5.50  2.02   1.71   3.31  9.56  1.00    4111.    4292.
10 a[10]     3.58   3.38  1.25   1.11   1.94  5.91  1.00    4605.    4838.
11 b[1]      1.34   1.31  0.247  0.219  1.00  1.78  1.00    3947.    7603.
12 b[2]      1.47   1.45  0.206  0.187  1.17  1.83  1.00    2856.    5512.
13 b[3]      1.78   1.73  0.320  0.263  1.38  2.35  1.00    2872.    5606.
14 b[4]      1.48   1.47  0.178  0.167  1.22  1.79  1.00    2101.    4385.
15 b[5]      1.26   1.26  0.124  0.123  1.06  1.47  1.00    1732.    4593.
16 b[6]      1.65   1.62  0.229  0.206  1.33  2.05  1.00    2438.    4697.
17 b[7]      1.61   1.59  0.208  0.192  1.31  1.98  1.00    2122.    4366.
18 b[8]      1.62   1.61  0.158  0.156  1.37  1.89  1.00    1494.    3405.
19 b[9]      1.27   1.27  0.136  0.136  1.06  1.51  1.00    1858.    4873.
20 b[10]     1.71   1.67  0.259  0.223  1.36  2.15  1.00    2639.    4852.</code></pre>
</div>
</div>
</section>
<section id="estimating-the-discriminationdifficulty-model" class="slide level2">
<h2>Estimating the Discrimination/Difficulty Model</h2>
<p>A change is needed to Stan’s model statement to directly estimate the discrimination/difficulty model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a>model {</span>
<span id="cb13-2"><a href=""></a>  </span>
<span id="cb13-3"><a href=""></a>  a <span class="sc">~</span> <span class="fu">multi_normal</span>(meanA, covA); <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> item discrimination<span class="sc">/</span>factor loadings</span>
<span id="cb13-4"><a href=""></a>  b <span class="sc">~</span> <span class="fu">multi_normal</span>(meanB, covB);             <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> item intercepts</span>
<span id="cb13-5"><a href=""></a>  </span>
<span id="cb13-6"><a href=""></a>  theta <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>);                         <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> latent <span class="fu">variable</span> (with mean<span class="sc">/</span>sd specified)</span>
<span id="cb13-7"><a href=""></a>  </span>
<span id="cb13-8"><a href=""></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb13-9"><a href=""></a>    Y[item] <span class="sc">~</span> <span class="fu">bernoulli_logit</span>(a[item]<span class="sc">*</span>(theta <span class="sc">-</span> b[item]));</span>
<span id="cb13-10"><a href=""></a>  }</span>
<span id="cb13-11"><a href=""></a>  </span>
<span id="cb13-12"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also estimate the slope/intercept parameters from the discrimination/difficulty parameters:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a>generated quantities{</span>
<span id="cb14-2"><a href=""></a>  vector[nItems] lambda;</span>
<span id="cb14-3"><a href=""></a>  vector[nItems] mu;</span>
<span id="cb14-4"><a href=""></a>  </span>
<span id="cb14-5"><a href=""></a>  lambda <span class="ot">=</span> a;</span>
<span id="cb14-6"><a href=""></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb14-7"><a href=""></a>    mu[item] <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>a[item]<span class="sc">*</span>b[item];</span>
<span id="cb14-8"><a href=""></a>  }</span>
<span id="cb14-9"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-results-1" class="slide level2">
<h2>Model Results</h2>
<p>Checking convergence:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.001807</code></pre>
</div>
</div>
<p>Checking parameter estimates:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 10
   variable  mean median     sd    mad    q5   q95  rhat ess_bulk ess_tail
   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 a[1]      1.64   1.61  0.435  0.422 0.985  2.40  1.00    6190.    7045.
 2 a[2]      2.70   2.59  0.798  0.735 1.59   4.17  1.00    7226.    9782.
 3 a[3]      2.28   2.18  0.783  0.715 1.20   3.68  1.00    6318.    8130.
 4 a[4]      3.88   3.66  1.33   1.13  2.18   6.31  1.00    7213.    8982.
 5 a[5]     12.3    7.69 12.5    4.23  3.72  39.5   1.00    3141.    3986.
 6 a[6]      3.23   3.03  1.20   1.02  1.71   5.46  1.00    6678.    7698.
 7 a[7]      3.54   3.34  1.25   1.09  1.92   5.82  1.00    6749.    7760.
 8 a[8]     27.4   23.4  18.0   17.0   6.12  62.4   1.00    4708.    2832.
 9 a[9]      4.72   4.45  1.60   1.35  2.74   7.52  1.00    6449.    7794.
10 a[10]     2.82   2.68  0.968  0.866 1.53   4.62  1.00    7614.    8970.
11 b[1]      1.48   1.43  0.303  0.257 1.09   2.02  1.00    4944.    7147.
12 b[2]      1.60   1.58  0.236  0.214 1.27   2.03  1.00    4295.    7585.
13 b[3]      2.03   1.95  0.410  0.328 1.53   2.79  1.00    4731.    7224.
14 b[4]      1.62   1.61  0.200  0.186 1.33   1.97  1.00    3659.    6639.
15 b[5]      1.34   1.34  0.135  0.135 1.13   1.57  1.00    2752.    5870.
16 b[6]      1.85   1.81  0.294  0.250 1.47   2.35  1.00    3747.    6667.
17 b[7]      1.79   1.76  0.251  0.222 1.45   2.23  1.00    3546.    6637.
18 b[8]      1.77   1.76  0.172  0.165 1.50   2.06  1.00    1890.    1941.
19 b[9]      1.36   1.36  0.151  0.148 1.13   1.62  1.00    3269.    6883.
20 b[10]     1.92   1.87  0.325  0.268 1.50   2.50  1.00    4680.    7669.</code></pre>
</div>
</div>
</section>
<section id="comparing-difficulty-parameters" class="slide level2">
<h2>Comparing Difficulty Parameters</h2>
<p>Difficulty parameters from discrimination/difficulty model:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 10
   variable  mean median    sd   mad    q5   q95  rhat ess_bulk ess_tail
   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 b[1]      1.48   1.43 0.303 0.257  1.09  2.02  1.00    4944.    7147.
 2 b[2]      1.60   1.58 0.236 0.214  1.27  2.03  1.00    4295.    7585.
 3 b[3]      2.03   1.95 0.410 0.328  1.53  2.79  1.00    4731.    7224.
 4 b[4]      1.62   1.61 0.200 0.186  1.33  1.97  1.00    3659.    6639.
 5 b[5]      1.34   1.34 0.135 0.135  1.13  1.57  1.00    2752.    5870.
 6 b[6]      1.85   1.81 0.294 0.250  1.47  2.35  1.00    3747.    6667.
 7 b[7]      1.79   1.76 0.251 0.222  1.45  2.23  1.00    3546.    6637.
 8 b[8]      1.77   1.76 0.172 0.165  1.50  2.06  1.00    1890.    1941.
 9 b[9]      1.36   1.36 0.151 0.148  1.13  1.62  1.00    3269.    6883.
10 b[10]     1.92   1.87 0.325 0.268  1.50  2.50  1.00    4680.    7669.</code></pre>
</div>
</div>
<p>Difficulty parameters from slope/intercept model:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 10
   variable  mean median    sd   mad    q5   q95  rhat ess_bulk ess_tail
   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 b[1]      1.34   1.31 0.247 0.219  1.00  1.78  1.00    3947.    7603.
 2 b[2]      1.47   1.45 0.206 0.187  1.17  1.83  1.00    2856.    5512.
 3 b[3]      1.78   1.73 0.320 0.263  1.38  2.35  1.00    2872.    5606.
 4 b[4]      1.48   1.47 0.178 0.167  1.22  1.79  1.00    2101.    4385.
 5 b[5]      1.26   1.26 0.124 0.123  1.06  1.47  1.00    1732.    4593.
 6 b[6]      1.65   1.62 0.229 0.206  1.33  2.05  1.00    2438.    4697.
 7 b[7]      1.61   1.59 0.208 0.192  1.31  1.98  1.00    2122.    4366.
 8 b[8]      1.62   1.61 0.158 0.156  1.37  1.89  1.00    1494.    3405.
 9 b[9]      1.27   1.27 0.136 0.136  1.06  1.51  1.00    1858.    4873.
10 b[10]     1.71   1.67 0.259 0.223  1.36  2.15  1.00    2639.    4852.</code></pre>
</div>
</div>
</section>
<section id="comparing-difficulty-parameters-plot" class="slide level2">
<h2>Comparing Difficulty Parameters: Plot</h2>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-34-1.png" width="960" class="r-stretch"></section>
<section id="comparing-discrimination-parameters" class="slide level2">
<h2>Comparing Discrimination Parameters</h2>
<p>Discrimination parameters from discrimination/difficulty model:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 10
   variable  mean median     sd    mad    q5   q95  rhat ess_bulk ess_tail
   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 a[1]      1.64   1.61  0.435  0.422 0.985  2.40  1.00    6190.    7045.
 2 a[2]      2.70   2.59  0.798  0.735 1.59   4.17  1.00    7226.    9782.
 3 a[3]      2.28   2.18  0.783  0.715 1.20   3.68  1.00    6318.    8130.
 4 a[4]      3.88   3.66  1.33   1.13  2.18   6.31  1.00    7213.    8982.
 5 a[5]     12.3    7.69 12.5    4.23  3.72  39.5   1.00    3141.    3986.
 6 a[6]      3.23   3.03  1.20   1.02  1.71   5.46  1.00    6678.    7698.
 7 a[7]      3.54   3.34  1.25   1.09  1.92   5.82  1.00    6749.    7760.
 8 a[8]     27.4   23.4  18.0   17.0   6.12  62.4   1.00    4708.    2832.
 9 a[9]      4.72   4.45  1.60   1.35  2.74   7.52  1.00    6449.    7794.
10 a[10]     2.82   2.68  0.968  0.866 1.53   4.62  1.00    7614.    8970.</code></pre>
</div>
</div>
<p>Discrimination parameters from slope/intercept model:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 10
   variable  mean median     sd    mad    q5   q95  rhat ess_bulk ess_tail
   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 a[1]      1.90   1.85  0.497  0.475  1.16  2.79  1.00    5014.    6030.
 2 a[2]      3.21   3.07  0.993  0.887  1.88  5.03  1.00    4973.    4384.
 3 a[3]      2.88   2.73  1.01   0.895  1.54  4.75  1.00    3794.    4924.
 4 a[4]      4.87   4.54  1.79   1.54   2.64  8.15  1.00    4145.    5161.
 5 a[5]     13.1    9.91  9.43   5.49   4.57 33.1   1.00    2954.    3607.
 6 a[6]      4.20   3.89  1.67   1.39   2.16  7.14  1.00    3541.    3780.
 7 a[7]      4.64   4.31  1.88   1.48   2.44  7.85  1.00    4063.    3651.
 8 a[8]     21.8   20.2  10.6   10.5    7.47 41.8   1.00    6391.    8311.
 9 a[9]      5.86   5.50  2.02   1.71   3.31  9.56  1.00    4111.    4292.
10 a[10]     3.58   3.38  1.25   1.11   1.94  5.91  1.00    4605.    4838.</code></pre>
</div>
</div>
</section>
<section id="comparing-discrimination-parameters-plot" class="slide level2">
<h2>Comparing Discrimination Parameters: Plot</h2>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-37-1.png" width="960" class="r-stretch"></section>
<section id="comparing-theta-eap-estimates" class="slide level2">
<h2>Comparing Theta EAP Estimates</h2>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-38-1.png" width="960" class="r-stretch"></section>
<section id="comparing-theta-sd-estimates" class="slide level2">
<h2>Comparing Theta SD Estimates</h2>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-39-1.png" width="960" class="r-stretch"></section>
<section id="posterior-distributions-are-different" class="slide level2">
<h2>Posterior Distributions Are Different</h2>
<p>Although the parameters of each type of model can be found from the others, the posterior distributions are not the same</p>
<ul>
<li>Prior distributions are defined on the coded model parameters</li>
<li>Posterior distributions are not necessarily the same
<ul>
<li>But are linearly related (in this case)</li>
</ul></li>
<li>More extreme choices of priors would lead to more extreme differences</li>
</ul>
</section>
<section id="section-5" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Estimating IRT Model Auxiliary Statistics</p>
</div>
</section>
<section id="estimating-irt-model-auxiliary-statistics" class="slide level2">
<h2>Estimating IRT Model Auxiliary Statistics</h2>
<p>We can also use the generated quantities block to estimate some important auxiliary statitics from IRT models</p>
<ul>
<li>Test characteristic curve estimates (with posterior standard deviations); TCC</li>
<li>Item information functions (with posterior standard deviations); IIF</li>
<li>Test information functions (with posterior standard deviations); TIF</li>
</ul>
<p>Shown for the discrimination/difficulty parameterization (but applies to slope/intercept, too)</p>
<p>The key:</p>
<ul>
<li>Define a set of <span class="math inline">\(\theta\)</span> values and import them into Stan</li>
<li>Then calculate each statistic using (conditional on) each value of <span class="math inline">\(\theta\)</span> imported</li>
</ul>
</section>
<section id="range-of-theta" class="slide level2">
<h2>Range of <span class="math inline">\(\theta\)</span></h2>
<p>To begin, define a range of <span class="math inline">\(\theta\)</span> over which you wish to calculate these statistics</p>
<ul>
<li>As we’ve used a standardized <span class="math inline">\(\theta\)</span>, we can define that range being from <span class="math inline">\(\[-3, 3\]\)</span>
<ul>
<li>Covers about 99% of the distribution of <span class="math inline">\(\theta\)</span></li>
</ul></li>
<li>Here, I am creating a sequence that adds .01 to each successive values (only first 10 shown)
<ul>
<li>Makes for better plots</li>
<li>More values (smaller interval) slows the estimation process down</li>
<li>More values also takes more memory to store chains</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a>thetaVals <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>,.<span class="dv">01</span>)</span>
<span id="cb21-2"><a href=""></a>thetaVals[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -3.00 -2.99 -2.98 -2.97 -2.96 -2.95 -2.94 -2.93 -2.92 -2.91</code></pre>
</div>
</div>
</section>
<section id="test-characteristic-curves" class="slide level2">
<h2>Test Characteristic Curves</h2>
<p>The test characteristic curve is formed by taking the sum of the expected value for each item, conditional on a value of <span class="math inline">\(\theta\)</span></p>
<p><span class="math display">\[TCC(\theta) = \sum_{i=1}^I \frac{\exp \left(a_i \left(\theta -b_i \right) \right)}{1+ \exp \left(a_i \left(\theta-b_i \right) \right)}\]</span></p>
<p>We must compute this for each imported value of <span class="math inline">\(\theta\)</span> across all iterations of the Markov Chain</p>
</section>
<section id="tcc-plots" class="slide level2">
<h2>TCC Plots</h2>
<p>Each TCC theta-to-raw score conversion has its own posterior standard error</p>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-41-1.png" width="960" class="r-stretch"></section>
<section id="item-information" class="slide level2">
<h2>Item Information</h2>
<p>An item information function quantifies the amount of information about the latent trait provided by an item</p>
<ul>
<li>Note: the derivation of information is for MAP estimates (so not the contribution to the posterior standard deviation)</li>
</ul>
<p>For a given value of <span class="math inline">\(\theta\)</span>, we can calculate an item’s information by taking the second partial derivative the model/data likelihood for an time with respect to <span class="math inline">\(\theta\)</span></p>
<ul>
<li>For the two-parameter logistic model this is:</li>
</ul>
<p><span class="math display">\[I_i\left( \theta \right) = a_i^2 \left(\frac{\exp \left(a_i \left(\theta -b_i \right) \right)}{1+ \exp \left(a_i \left(\theta-b_i \right) \right)} \right) \left(1-\frac{\exp \left(a_i \left(\theta -b_i \right) \right)}{1+ \exp \left(a_i \left(\theta-b_i \right) \right)} \right)\]</span></p>
</section>
<section id="item-information-from-markov-chains" class="slide level2">
<h2>Item Information from Markov Chains</h2>
<p>Using generated quantities, we can also calculate the item information for each item at each step of the chain.</p>
<ul>
<li>We must also use a set of theta values to calculate this across (as with the TCC)</li>
</ul>
</section>
<section id="item-information-functions" class="slide level2">
<h2>Item Information Functions</h2>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-42-1.png" width="960" class="r-stretch"></section>
<section id="test-information-function" class="slide level2">
<h2>Test Information Function</h2>
<p>The test information function is the sum of the item information functions for a given value of <span class="math inline">\(\theta\)</span></p>
<ul>
<li>But, as we are in Bayesian, we must also include the information from the prior distribution of <span class="math inline">\(\theta\)</span>
<ul>
<li>Found by taking the second partial derivative of the pdf of the prior distribution with respect to <span class="math inline">\(\theta\)</span></li>
<li>When <span class="math inline">\(\theta\)</span> has the standardized factor parameterization, this value is simply -1</li>
</ul></li>
<li>We can use Stan’s generated quantities to calculate this, too</li>
</ul>
<p>For the 2PL model, the test information function is then:</p>
<p><span class="math display">\[TIF\left( \theta \right) = -1+ \sum_{i=1}^I a_i^2 \left(\frac{\exp \left(a_i \left(\theta -b_i \right) \right)}{1+ \exp \left(a_i \left(\theta-b_i \right) \right)} \right) \left(1-\frac{\exp \left(a_i \left(\theta -b_i \right) \right)}{1+ \exp \left(a_i \left(\theta-b_i \right) \right)} \right)\]</span></p>
</section>
<section id="tif-spaghetti-plots" class="slide level2">
<h2>TIF Spaghetti Plots</h2>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-43-1.png" width="960" class="r-stretch"></section>
<section id="eap-tif-plot" class="slide level2">
<h2>EAP TIF Plot</h2>

<img data-src="04c_Modeling_Observed_Dichotomous_Data_files/figure-revealjs/unnamed-chunk-44-1.png" width="960" class="r-stretch"></section>
<section id="section-6" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Other IRT/IFA Models</p>
</div>
</section>
<section id="other-irtifa-models" class="slide level2">
<h2>Other IRT/IFA Models</h2>
<p>There are a number of different IRT models that can be implemented in Stan</p>
<ul>
<li>A slight change is needed in the model statement for the observed data</li>
</ul>
<p>Up to now, for the 2PL model, we had:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a>model {</span>
<span id="cb23-2"><a href=""></a>  </span>
<span id="cb23-3"><a href=""></a>  a <span class="sc">~</span> <span class="fu">multi_normal</span>(meanA, covA); <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> item discrimination<span class="sc">/</span>factor loadings</span>
<span id="cb23-4"><a href=""></a>  b <span class="sc">~</span> <span class="fu">multi_normal</span>(meanB, covB);             <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> item intercepts</span>
<span id="cb23-5"><a href=""></a>  </span>
<span id="cb23-6"><a href=""></a>  theta <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>);                         <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> latent <span class="fu">variable</span> (with mean<span class="sc">/</span>sd specified)</span>
<span id="cb23-7"><a href=""></a>  </span>
<span id="cb23-8"><a href=""></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb23-9"><a href=""></a>    Y[item] <span class="sc">~</span> <span class="fu">bernoulli_logit</span>(a[item]<span class="sc">*</span>(theta <span class="sc">-</span> b[item]));</span>
<span id="cb23-10"><a href=""></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function <code>bernoulli_logit()</code> will only work for the 1- and 2PL models</p>
<ul>
<li>It applies the logit link function to the inner portion of the function, then transforms it to a probability, then evaluates the Bernoulli likelihood</li>
</ul>
</section>
<section id="slight-change-in-parameterization" class="slide level2">
<h2>Slight Change in Parameterization</h2>
<p>To make this more general, we must construct the model using just the Bernoulli function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href=""></a>model {</span>
<span id="cb24-2"><a href=""></a>  </span>
<span id="cb24-3"><a href=""></a>  a <span class="sc">~</span> <span class="fu">multi_normal</span>(meanA, covA); <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> item discrimination<span class="sc">/</span>factor loadings</span>
<span id="cb24-4"><a href=""></a>  b <span class="sc">~</span> <span class="fu">multi_normal</span>(meanB, covB);             <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> item intercepts</span>
<span id="cb24-5"><a href=""></a>  </span>
<span id="cb24-6"><a href=""></a>  theta <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>);                         <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> latent <span class="fu">variable</span> (with mean<span class="sc">/</span>sd specified)</span>
<span id="cb24-7"><a href=""></a>  </span>
<span id="cb24-8"><a href=""></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb24-9"><a href=""></a>    Y[item] <span class="sc">~</span> <span class="fu">bernoulli</span>(<span class="fu">inv_logit</span>(a[item]<span class="sc">*</span>(theta <span class="sc">-</span> b[item])));</span>
<span id="cb24-10"><a href=""></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, the result of <code>inv_logit()</code> is a probability for each person and item</p>
<ul>
<li>Then, the <code>bernoulli()</code> function calculates the likelihood based on the probability from each item</li>
</ul>
</section>
<section id="pl-model" class="slide level2">
<h2>1PL Model</h2>
<p>Item Response Function: <span class="math display">\[ P\left(Y_{pi} = 1 \mid \theta_p \right) = \frac{\exp \left(\theta -b_i \right)}{1+ \exp \left(\theta-b_i \right)} \]</span></p>
<p>The 1PL model can be built by removing the <span class="math inline">\(a\)</span> parameter:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href=""></a>data {</span>
<span id="cb25-2"><a href=""></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> nObs;                 <span class="sc">/</span><span class="er">/</span> number of observations</span>
<span id="cb25-3"><a href=""></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> nItems;               <span class="sc">/</span><span class="er">/</span> number of items</span>
<span id="cb25-4"><a href=""></a>  array[nItems, nObs] int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span>, upper<span class="ot">=</span><span class="dv">1</span><span class="sc">&gt;</span>  Y; <span class="sc">/</span><span class="er">/</span> item responses <span class="cf">in</span> a matrix</span>
<span id="cb25-5"><a href=""></a>  </span>
<span id="cb25-6"><a href=""></a>  vector[nItems] meanB;         <span class="sc">/</span><span class="er">/</span> prior mean vector <span class="cf">for</span> coefficients</span>
<span id="cb25-7"><a href=""></a>  matrix[nItems, nItems] covB;  <span class="sc">/</span><span class="er">/</span> prior covariance matrix <span class="cf">for</span> coefficients</span>
<span id="cb25-8"><a href=""></a>}</span>
<span id="cb25-9"><a href=""></a></span>
<span id="cb25-10"><a href=""></a>parameters {</span>
<span id="cb25-11"><a href=""></a>  vector[nObs] theta;               <span class="sc">/</span><span class="er">/</span> the latent <span class="fu">variables</span> (one <span class="cf">for</span> each person)</span>
<span id="cb25-12"><a href=""></a>  vector[nItems] b;                 <span class="sc">/</span><span class="er">/</span> the factor loadings<span class="sc">/</span>item <span class="fu">discriminations</span> (one <span class="cf">for</span> each item)</span>
<span id="cb25-13"><a href=""></a>  real<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> sdTheta;            <span class="sc">/</span><span class="er">/</span> standard deviation <span class="cf">for</span> latent variable</span>
<span id="cb25-14"><a href=""></a>}</span>
<span id="cb25-15"><a href=""></a></span>
<span id="cb25-16"><a href=""></a>model {</span>
<span id="cb25-17"><a href=""></a>  b <span class="sc">~</span> <span class="fu">multi_normal</span>(meanB, covB);             <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> item intercepts</span>
<span id="cb25-18"><a href=""></a>  theta <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, sdTheta);                <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> latent <span class="fu">variable</span> (with mean specified<span class="sc">/</span>sd estimated)</span>
<span id="cb25-19"><a href=""></a>  sdTheta <span class="sc">~</span> <span class="fu">exponential</span>(.<span class="dv">1</span>);                 <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> latent variable standard deviation</span>
<span id="cb25-20"><a href=""></a>  </span>
<span id="cb25-21"><a href=""></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb25-22"><a href=""></a>    Y[item] <span class="sc">~</span> <span class="fu">bernoulli</span>(<span class="fu">inv_logit</span>(theta <span class="sc">-</span> b[item]));</span>
<span id="cb25-23"><a href=""></a>  }</span>
<span id="cb25-24"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pl-model-1" class="slide level2">
<h2>3PL Model</h2>
<p>Item Response Function: <span class="math display">\[ P\left(Y_{pi} = 1 \mid \theta_p \right) = c_i +\left(1-c_i\right)\left[\frac{\exp \left(a_i \left(\theta -b_i \right) \right)}{1+ \exp \left(a_i \left(\theta-b_i \right) \right)}\right] \]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href=""></a>parameters {</span>
<span id="cb26-2"><a href=""></a>  vector[nObs] theta;                <span class="sc">/</span><span class="er">/</span> the latent <span class="fu">variables</span> (one <span class="cf">for</span> each person)</span>
<span id="cb26-3"><a href=""></a>  vector[nItems] a;</span>
<span id="cb26-4"><a href=""></a>  vector[nItems] b;             <span class="sc">/</span><span class="er">/</span> the factor loadings<span class="sc">/</span>item <span class="fu">discriminations</span> (one <span class="cf">for</span> each item)</span>
<span id="cb26-5"><a href=""></a>  vector<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span>, upper<span class="ot">=</span><span class="dv">1</span><span class="sc">&gt;</span>[nItems] c;</span>
<span id="cb26-6"><a href=""></a>}</span>
<span id="cb26-7"><a href=""></a></span>
<span id="cb26-8"><a href=""></a>model {</span>
<span id="cb26-9"><a href=""></a>  a <span class="sc">~</span> <span class="fu">multi_normal</span>(meanA, covA);             <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> item intercepts</span>
<span id="cb26-10"><a href=""></a>  b <span class="sc">~</span> <span class="fu">multi_normal</span>(meanB, covB);             <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> item intercepts</span>
<span id="cb26-11"><a href=""></a>  c <span class="sc">~</span> <span class="fu">beta</span>(<span class="dv">1</span>,<span class="dv">1</span>);                              <span class="sc">/</span><span class="er">/</span> Simple prior <span class="cf">for</span> c parameter</span>
<span id="cb26-12"><a href=""></a>  </span>
<span id="cb26-13"><a href=""></a>  theta <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>);                         <span class="sc">/</span><span class="er">/</span> Prior <span class="cf">for</span> latent <span class="fu">variable</span> (with mean<span class="sc">/</span>sd specified)</span>
<span id="cb26-14"><a href=""></a>  </span>
<span id="cb26-15"><a href=""></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb26-16"><a href=""></a>    Y[item] <span class="sc">~</span> <span class="fu">bernoulli</span>(c[item] <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>c[item])<span class="sc">*</span><span class="fu">inv_logit</span>(a[item]<span class="sc">*</span>(theta <span class="sc">-</span> b[item])));</span>
<span id="cb26-17"><a href=""></a>  }</span>
<span id="cb26-18"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="two-parameter-normal-ogive-model" class="slide level2">
<h2>Two-Parameter Normal Ogive Model</h2>
<p>Item Response Function: <span class="math display">\[ P\left(Y_{pi} = 1 \mid \theta_p \right) =  \Phi \left(a_i \left(\theta -b_i \right)\right) \]</span></p>
<p>Stan’s function <code>Phi()</code> converts the term in the function to a probability using the inverse normal CDF</p>
</section>
<section id="section-7" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Wrapping Up</p>
</div>
</section>
<section id="wrapping-up" class="slide level2">
<h2>Wrapping Up</h2>
<p>This lecture covered models for dichotomous data</p>
<ul>
<li>Many different models can be estimated using Stan with minimal changes to syntax</li>
<li>All IRT auxiliary statistics (i.e, TIF, TCC, IIF) can be computed within Stan</li>
</ul>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p><a href="https://jonathantemplin.com/bayesian-psychometric-modeling-fall-2024/">https://jonathantemplin.com/bayesian-psychometric-modeling-fall-2024/</a></p>
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="04c_Modeling_Observed_Dichotomous_Data_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="04c_Modeling_Observed_Dichotomous_Data_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="04c_Modeling_Observed_Dichotomous_Data_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="04c_Modeling_Observed_Dichotomous_Data_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="04c_Modeling_Observed_Dichotomous_Data_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="04c_Modeling_Observed_Dichotomous_Data_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="04c_Modeling_Observed_Dichotomous_Data_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="04c_Modeling_Observed_Dichotomous_Data_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="04c_Modeling_Observed_Dichotomous_Data_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="04c_Modeling_Observed_Dichotomous_Data_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>